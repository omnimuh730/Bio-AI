<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Bio AI - Analysis</title>
		<link
			href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&family=Inter:wght@400;500;600&display=swap"
			rel="stylesheet"
		/>
		<link
			rel="stylesheet"
			href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
		/>

		<style>
			:root {
				/* Brand Colors */
				--primary: #4b7bff;
				--primary-dark: #2563eb;
				--secondary-purple: #8b5cf6; /* Metric 2 Color */
				--accent-green: #10b981;

				--bg-body: #f2f5f9;
				--surface: #ffffff;
				--text-main: #1e293b;
				--text-secondary: #64748b;

				--radius-card: 24px;
				--radius-btn: 12px;
			}

			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
				-webkit-tap-highlight-color: transparent;
			}

			body {
				font-family: "DM Sans", sans-serif;
				background-color: var(--bg-body);
				display: flex;
				justify-content: center;
				min-height: 100vh;
			}

			.app-container {
				width: 100%;
				max-width: 414px;
				background-color: var(--bg-body);
				position: relative;
				padding-bottom: 100px;
				min-height: 100vh;
				overflow-x: hidden;
				box-shadow: 0 0 50px rgba(0, 0, 0, 0.05);
			}

			.header {
				padding: 24px;
				display: flex;
				justify-content: space-between;
				align-items: center;
			}
			.header h1 {
				font-size: 22px;
				font-weight: 700;
				color: var(--text-main);
			}

			.empty-state {
				margin: 20px 24px;
				background: var(--surface);
				border-radius: var(--radius-card);
				padding: 24px;
				text-align: center;
				box-shadow: 0 4px 20px rgba(0, 0, 0, 0.02);
				display: none;
			}

			.empty-illustration {
				width: 120px;
				height: 120px;
				border-radius: 50%;
				background: radial-gradient(
					circle,
					rgba(75, 123, 255, 0.12) 0%,
					rgba(255, 255, 255, 0) 70%
				);
				margin: 0 auto 16px;
				display: flex;
				align-items: center;
				justify-content: center;
				color: var(--primary);
				font-size: 28px;
			}

			.empty-state h2 {
				font-size: 18px;
				color: var(--text-main);
				margin-bottom: 8px;
			}

			.empty-state p {
				font-size: 12px;
				color: var(--text-secondary);
				margin-bottom: 16px;
			}

			/* --- SECTION 1B: DAILY SUMMARY --- */
			.summary-section {
				padding: 0 24px;
				margin-bottom: 20px;
			}

			.summary-grid {
				display: grid;
				grid-template-columns: repeat(2, 1fr);
				gap: 12px;
			}

			.summary-card {
				background: var(--surface);
				border-radius: 18px;
				padding: 14px;
				box-shadow: 0 4px 10px rgba(0, 0, 0, 0.02);
				display: flex;
				align-items: center;
				gap: 10px;
			}

			.summary-icon {
				width: 36px;
				height: 36px;
				border-radius: 12px;
				display: flex;
				align-items: center;
				justify-content: center;
				font-size: 16px;
			}

			.summary-icon.blue {
				background: rgba(75, 123, 255, 0.12);
				color: var(--primary);
			}
			.summary-icon.purple {
				background: rgba(139, 92, 246, 0.12);
				color: var(--secondary-purple);
			}
			.summary-icon.green {
				background: rgba(16, 185, 129, 0.12);
				color: var(--accent-green);
			}
			.summary-icon.gray {
				background: #f1f5f9;
				color: var(--text-secondary);
			}

			.summary-meta span {
				display: block;
				font-size: 12px;
				color: var(--text-secondary);
			}

			.summary-meta strong {
				font-size: 16px;
				color: var(--text-main);
			}

			/* --- SECTION 1: ENERGY SCORE --- */
			.score-section {
				padding: 0 24px;
				margin-bottom: 24px;
			}

			.score-card {
				background: var(--surface);
				border-radius: var(--radius-card);
				padding: 24px;
				text-align: center;
				box-shadow: 0 4px 20px rgba(0, 0, 0, 0.02);
				position: relative;
				overflow: hidden;
			}

			/* Decorative background blur */
			.score-card::before {
				content: "";
				position: absolute;
				top: -50px;
				left: 50%;
				transform: translateX(-50%);
				width: 200px;
				height: 200px;
				background: radial-gradient(
					circle,
					rgba(75, 123, 255, 0.1) 0%,
					transparent 70%
				);
			}

			/* Gauge Arc (CSS Only) */
			.gauge-container {
				width: 180px;
				height: 90px; /* Half circle space */
				margin: 0 auto 10px;
				position: relative;
				overflow: hidden;
			}

			.gauge-bg {
				width: 180px;
				height: 180px;
				border-radius: 50%;
				border: 15px solid #f1f5f9;
				box-sizing: border-box;
			}

			.gauge-fill {
				position: absolute;
				top: 0;
				left: 0;
				width: 180px;
				height: 180px;
				border-radius: 50%;
				border: 15px solid transparent;
				border-top-color: var(--primary);
				border-right-color: var(--primary); /* Makes it 50% */
				transform: rotate(-45deg); /* Adjust based on score */
				box-sizing: border-box;
				transition: transform 1s ease-out;
			}

			.score-val {
				font-size: 42px;
				font-weight: 800;
				color: var(--text-main);
				margin-top: -10px;
				display: block;
			}
			.score-label {
				font-size: 13px;
				color: var(--text-secondary);
				font-weight: 600;
				text-transform: uppercase;
				letter-spacing: 1px;
			}

			/* AI Insight Box */
			.insight-box {
				margin-top: 16px;
				background: #f0f9ff;
				border-radius: 16px;
				padding: 12px 16px;
				text-align: left;
				display: flex;
				gap: 12px;
				align-items: flex-start;
			}

			.insight-icon {
				color: var(--primary);
				font-size: 16px;
				margin-top: 2px;
			}
			.insight-text {
				font-size: 13px;
				color: #334155;
				line-height: 1.4;
			}
			.insight-text strong {
				color: var(--primary-dark);
			}

			/* --- SECTION 2: TREND GRAPHS --- */
			.graph-section {
				padding: 0 24px;
				margin-bottom: 24px;
			}

			.section-header {
				display: flex;
				justify-content: space-between;
				align-items: center;
				margin-bottom: 12px;
			}
			.sec-title {
				font-size: 16px;
				font-weight: 700;
			}

			/* Time Selector */
			.time-toggle {
				background: #e2e8f0;
				border-radius: 10px;
				padding: 2px;
				display: flex;
			}
			.time-opt {
				padding: 4px 12px;
				font-size: 11px;
				font-weight: 600;
				border-radius: 8px;
				color: var(--text-secondary);
				cursor: pointer;
			}
			.time-opt.active {
				background: white;
				color: var(--text-main);
				box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
			}

			/* The Graph Card */
			.graph-card {
				background: var(--surface);
				border-radius: var(--radius-card);
				padding: 20px;
				box-shadow: 0 4px 10px rgba(0, 0, 0, 0.02);
			}

			.metric-selectors {
				display: flex;
				gap: 10px;
				margin-bottom: 20px;
			}

			.metric-pill {
				flex: 1;
				padding: 8px 12px;
				border-radius: 12px;
				font-size: 12px;
				font-weight: 600;
				display: flex;
				justify-content: space-between;
				align-items: center;
				cursor: pointer;
				position: relative;
			}

			.pill-a {
				background: rgba(75, 123, 255, 0.1);
				color: var(--primary);
				border: 1px solid rgba(75, 123, 255, 0.2);
			}
			.pill-b {
				background: rgba(139, 92, 246, 0.1);
				color: var(--secondary-purple);
				border: 1px solid rgba(139, 92, 246, 0.2);
			}

			.metric-label {
				display: flex;
				align-items: center;
				gap: 8px;
			}

			.metric-menu {
				position: absolute;
				top: 42px;
				left: 0;
				right: 0;
				background: white;
				border: 1px solid #e2e8f0;
				border-radius: 12px;
				box-shadow: 0 12px 24px rgba(15, 23, 42, 0.1);
				padding: 8px;
				display: none;
				z-index: 20;
			}

			.metric-menu.show {
				display: block;
			}

			.metric-item {
				padding: 8px 10px;
				border-radius: 8px;
				font-size: 12px;
				color: var(--text-main);
				cursor: pointer;
			}

			.metric-item:hover {
				background: #f8fafc;
			}

			/* SVG Chart Simulation */
			.chart-area {
				height: 150px;
				width: 100%;
				position: relative;
				border-bottom: 1px solid #e2e8f0;
			}

			.chart-svg {
				width: 100%;
				height: 100%;
				overflow: visible;
			}

			/* Line 1: Primary (Sugar) */
			.line-primary {
				fill: none;
				stroke: var(--primary);
				stroke-width: 3;
				stroke-linecap: round;
				stroke-linejoin: round;
				filter: drop-shadow(0 4px 6px rgba(75, 123, 255, 0.3));
				animation: drawLine 2s ease-out forwards;
				stroke-dasharray: 1000;
				stroke-dashoffset: 1000;
			}

			/* Line 2: Secondary (Sleep) */
			.line-secondary {
				fill: none;
				stroke: var(--secondary-purple);
				stroke-width: 3;
				stroke-linecap: round;
				stroke-linejoin: round;
				stroke-dasharray: 5, 5; /* Dashed line for contrast */
				opacity: 0.6;
				animation: drawLine 2s ease-out forwards;
				stroke-dasharray: 1000;
				stroke-dashoffset: 1000;
			}

			@keyframes drawLine {
				to {
					stroke-dashoffset: 0;
				}
			}

			.x-axis {
				display: flex;
				justify-content: space-between;
				margin-top: 8px;
				font-size: 11px;
				color: var(--text-secondary);
			}

			/* --- SECTION 3: HISTORY LOG --- */
			.history-section {
				padding: 0 24px;
			}

			.history-list {
				display: flex;
				flex-direction: column;
				gap: 12px;
			}

			.history-item {
				background: var(--surface);
				padding: 16px;
				border-radius: 16px;
				display: flex;
				align-items: center;
				justify-content: space-between;
			}

			.h-left {
				display: flex;
				align-items: center;
				gap: 12px;
			}
			.h-time {
				background: #f1f5f9;
				padding: 6px 10px;
				border-radius: 8px;
				font-size: 11px;
				font-weight: 700;
				color: var(--text-secondary);
				display: flex;
				flex-direction: column;
				align-items: center;
				line-height: 1.2;
			}

			.h-info h4 {
				font-size: 14px;
				color: var(--text-main);
				font-weight: 600;
				margin-bottom: 2px;
			}
			.h-info p {
				font-size: 12px;
				color: var(--text-secondary);
			}

			.h-right {
				text-align: right;
			}
			.h-cal {
				font-size: 14px;
				font-weight: 700;
				color: var(--text-main);
				display: block;
			}
			.h-edit {
				font-size: 12px;
				color: var(--primary);
				cursor: pointer;
				margin-top: 4px;
				display: inline-block;
			}

			/* --- WEEKLY REVIEW --- */
			.review-card {
				margin: 12px 24px 24px;
				background: var(--surface);
				border-radius: var(--radius-card);
				padding: 20px;
				box-shadow: 0 4px 10px rgba(0, 0, 0, 0.02);
			}

			.review-header {
				display: flex;
				align-items: center;
				gap: 10px;
				font-size: 14px;
				font-weight: 700;
				margin-bottom: 10px;
			}

			.review-bubble {
				background: #f8fafc;
				border-radius: 16px;
				padding: 12px;
				font-size: 12px;
				color: var(--text-secondary);
				line-height: 1.4;
			}

			/* --- Floating Nav --- */
			.nav-floater {
				position: fixed;
				bottom: 30px;
				left: 50%;
				transform: translateX(-50%);
				background: rgba(255, 255, 255, 0.9);
				backdrop-filter: blur(16px);
				padding: 10px 24px;
				border-radius: 40px;
				box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
				display: flex;
				align-items: center;
				gap: 30px;
				z-index: 100;
				width: 85%;
				max-width: 360px;
				justify-content: space-between;
				border: 1px solid rgba(255, 255, 255, 0.5);
			}
			.nav-icon {
				font-size: 20px;
				color: var(--text-secondary);
				cursor: pointer;
			}
			.nav-icon.active {
				color: var(--text-main);
			}
			.nav-fab {
				width: 50px;
				height: 50px;
				background: var(--text-main);
				border-radius: 50%;
				display: flex;
				align-items: center;
				justify-content: center;
				color: white;
				font-size: 20px;
				margin-top: -20px;
				box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
				border: 4px solid var(--bg-body);
				text-decoration: none;
			}

			.nav-fab.active {
				background: var(--primary);
				box-shadow: 0 8px 20px rgba(37, 99, 235, 0.35);
			}

			.nav-link {
				text-decoration: none;
				display: flex;
				align-items: center;
				justify-content: center;
			}

			/* Modals */
			.modal {
				position: fixed;
				inset: 0;
				background: rgba(15, 23, 42, 0.4);
				display: flex;
				align-items: center;
				justify-content: center;
				padding: 24px;
				opacity: 0;
				pointer-events: none;
				transition: opacity 0.2s ease;
				z-index: 120;
			}

			.modal.active {
				opacity: 1;
				pointer-events: auto;
			}

			.modal-card {
				width: 100%;
				max-width: 360px;
				background: var(--surface);
				border-radius: 20px;
				padding: 20px;
				box-shadow: 0 20px 40px rgba(15, 23, 42, 0.2);
			}

			.modal-header {
				display: flex;
				align-items: center;
				justify-content: space-between;
				margin-bottom: 12px;
			}

			.modal-title {
				font-size: 16px;
				font-weight: 700;
			}

			.modal-close {
				border: none;
				background: #f1f5f9;
				width: 32px;
				height: 32px;
				border-radius: 10px;
				cursor: pointer;
			}

			.modal-actions {
				display: flex;
				gap: 10px;
				margin-top: 16px;
			}

			.btn-primary {
				flex: 1;
				background: var(--primary-dark);
				color: white;
				border: none;
				padding: 12px;
				border-radius: 12px;
				font-weight: 600;
				text-decoration: none;
				text-align: center;
			}

			.btn-secondary {
				flex: 1;
				background: #f1f5f9;
				color: var(--text-main);
				border: none;
				padding: 12px;
				border-radius: 12px;
				font-weight: 600;
				cursor: pointer;
			}

			/* Toast */
			.toast {
				position: fixed;
				bottom: 100px;
				left: 50%;
				transform: translateX(-50%);
				background: rgba(15, 23, 42, 0.9);
				color: white;
				padding: 10px 16px;
				border-radius: 12px;
				font-size: 12px;
				opacity: 0;
				pointer-events: none;
				transition: opacity 0.2s ease;
				z-index: 150;
			}

			.toast.show {
				opacity: 1;
			}
		</style>
	</head>
	<body>
		<div class="app-container">
			<div class="header">
				<h1>Analysis</h1>
				<i
					class="fa-solid fa-calendar-days"
					style="font-size: 20px; color: var(--text-main)"
				></i>
			</div>

			<div class="empty-state" id="emptyState">
				<div class="empty-illustration">
					<i class="fa-solid fa-seedling"></i>
				</div>
				<h2>Gathering your bio-data...</h2>
				<p>
					Log your first meals and sync your devices to unlock trends.
				</p>
				<button class="btn-primary" onclick="enableDemoData()">
					Load Demo Data
				</button>
			</div>

			<!-- 1. Energy Score -->
			<div class="score-section" data-section>
				<div class="score-card">
					<div class="gauge-container">
						<div class="gauge-bg"></div>
						<!-- Rotate logic: -135deg is 0%, -45deg is 50%, 45deg is 100% -->
						<div
							class="gauge-fill"
							style="transform: rotate(25deg)"
						></div>
					</div>
					<span class="score-val">88</span>
					<span class="score-label">Excellent Energy</span>

					<!-- AI Insight -->
					<div class="insight-box">
						<i class="fa-solid fa-robot insight-icon"></i>
						<p class="insight-text">
							<strong>Trend Up:</strong> Your score improved by
							12% this week. Consistent protein intake
							post-workout has improved your recovery speed.
						</p>
					</div>
				</div>
			</div>

			<div class="summary-section" data-section>
				<div class="summary-grid">
					<div class="summary-card">
						<div class="summary-icon blue">
							<i class="fa-solid fa-fire-flame-curved"></i>
						</div>
						<div class="summary-meta">
							<span>Calories</span>
							<strong>1,840 / 2,300</strong>
						</div>
					</div>
					<div class="summary-card">
						<div class="summary-icon purple">
							<i class="fa-solid fa-dna"></i>
						</div>
						<div class="summary-meta">
							<span>Protein</span>
							<strong>118g / 140g</strong>
						</div>
					</div>
					<div class="summary-card">
						<div class="summary-icon green">
							<i class="fa-solid fa-person-running"></i>
						</div>
						<div class="summary-meta">
							<span>Active Burn</span>
							<strong>620 kcal</strong>
						</div>
					</div>
					<div class="summary-card">
						<div class="summary-icon gray">
							<i class="fa-solid fa-moon"></i>
						</div>
						<div class="summary-meta">
							<span>Sleep Score</span>
							<strong>74 / 100</strong>
						</div>
					</div>
				</div>
			</div>

			<div class="review-card" data-section>
				<div class="review-header">
					<i
						class="fa-solid fa-robot"
						style="color: var(--primary)"
					></i>
					Weekly AI Review
				</div>
				<div class="review-bubble">
					You hit your protein goal 5 of 7 days. Sleep quality
					improved by 10%. I will stop suggesting oatmeal for now.
				</div>
			</div>

			<!-- 2. Trend Graphs -->
			<div class="graph-section" data-section>
				<div class="section-header">
					<span class="sec-title">Correlations</span>
					<div class="time-toggle">
						<div class="time-opt active" data-range="W">W</div>
						<div class="time-opt" data-range="M">M</div>
						<div class="time-opt" data-range="3M">3M</div>
					</div>
				</div>

				<div class="graph-card">
					<!-- Metric Selectors -->
					<div class="metric-selectors">
						<div class="metric-pill pill-a" data-slot="a">
							<div class="metric-label">
								<span class="metric-name" id="metricNameA"
									>Calorie Intake</span
								>
							</div>
							<i class="fa-solid fa-chevron-down"></i>
							<div class="metric-menu" id="metricMenuA">
								<div class="metric-item" data-metric="calories">
									Calorie Intake
								</div>
								<div class="metric-item" data-metric="protein">
									Protein Intake
								</div>
								<div class="metric-item" data-metric="carbs">
									Carb Intake
								</div>
								<div class="metric-item" data-metric="active">
									Active Burn
								</div>
								<div
									class="metric-item"
									data-metric="hydration"
								>
									Hydration
								</div>
							</div>
						</div>
						<div class="metric-pill pill-b" data-slot="b">
							<div class="metric-label">
								<span class="metric-name" id="metricNameB"
									>Sleep Quality</span
								>
							</div>
							<i class="fa-solid fa-chevron-down"></i>
							<div class="metric-menu" id="metricMenuB">
								<div class="metric-item" data-metric="sleep">
									Sleep Quality
								</div>
								<div class="metric-item" data-metric="energy">
									Energy Score
								</div>
								<div class="metric-item" data-metric="hrv">
									HRV / Stress
								</div>
								<div class="metric-item" data-metric="steps">
									Steps
								</div>
								<div class="metric-item" data-metric="mood">
									Mood
								</div>
							</div>
						</div>
					</div>

					<!-- CSS/SVG Graph -->
					<div class="chart-area">
						<svg
							class="chart-svg"
							viewBox="0 0 300 150"
							preserveAspectRatio="none"
						>
							<!-- Grid Lines (Optional) -->
							<line
								x1="0"
								y1="37"
								x2="300"
								y2="37"
								stroke="#F1F5F9"
								stroke-width="1"
							/>
							<line
								x1="0"
								y1="75"
								x2="300"
								y2="75"
								stroke="#F1F5F9"
								stroke-width="1"
							/>
							<line
								x1="0"
								y1="112"
								x2="300"
								y2="112"
								stroke="#F1F5F9"
								stroke-width="1"
							/>

							<!-- Line A: Calories (Blue) -->
							<polyline
								id="linePrimary"
								points="0,100 50,80 100,90 150,40 200,60 250,30 300,50"
								class="line-primary"
							/>

							<!-- Line B: Sleep (Purple) -->
							<polyline
								id="lineSecondary"
								points="0,120 50,100 100,110 150,60 200,70 250,50 300,60"
								class="line-secondary"
							/>
						</svg>
					</div>

					<div class="x-axis" id="xAxis">
						<span>Mon</span>
						<span>Tue</span>
						<span>Wed</span>
						<span>Thu</span>
						<span>Fri</span>
						<span>Sat</span>
						<span>Sun</span>
					</div>
				</div>
			</div>

			<!-- 3. History Log -->
			<div class="history-section" data-section>
				<div class="section-header">
					<span class="sec-title">Today's History</span>
				</div>

				<div class="history-list">
					<!-- Item 1 -->
					<div class="history-item">
						<div class="h-left">
							<div class="h-time">
								<span>12</span>
								<span>PM</span>
							</div>
							<div class="h-info">
								<h4>Magnesium Power Bowl</h4>
								<p>Quinoa, Avocado, Kale</p>
							</div>
						</div>
						<div class="h-right">
							<span class="h-cal">450</span>
							<span
								class="h-edit"
								onclick="
									openEdit(
										'Magnesium Power Bowl',
										'12:00 PM',
										'450',
									)
								"
								><i class="fa-solid fa-pen"></i> Edit</span
							>
						</div>
					</div>

					<!-- Item 2 -->
					<div class="history-item">
						<div class="h-left">
							<div class="h-time">
								<span>08</span>
								<span>AM</span>
							</div>
							<div class="h-info">
								<h4>Oatmeal & Berries</h4>
								<p>Rolled oats, Blueberry</p>
							</div>
						</div>
						<div class="h-right">
							<span class="h-cal">320</span>
							<span
								class="h-edit"
								onclick="
									openEdit(
										'Oatmeal and Berries',
										'08:00 AM',
										'320',
									)
								"
								><i class="fa-solid fa-pen"></i> Edit</span
							>
						</div>
					</div>

					<!-- Item 3 -->
					<div class="history-item">
						<div class="h-left">
							<div class="h-time">
								<span>03</span>
								<span>PM</span>
							</div>
							<div class="h-info">
								<h4>Protein Smoothie</h4>
								<p>Whey, Banana, Almond Milk</p>
							</div>
						</div>
						<div class="h-right">
							<span class="h-cal">260</span>
							<span
								class="h-edit"
								onclick="
									openEdit(
										'Protein Smoothie',
										'03:10 PM',
										'260',
									)
								"
								><i class="fa-solid fa-pen"></i> Edit</span
							>
						</div>
					</div>

					<!-- Item 3 -->
					<div class="history-item">
						<div class="h-left">
							<div class="h-time">
								<span>07</span>
								<span>AM</span>
							</div>
							<div class="h-info">
								<h4>Morning Run</h4>
								<p>Active Burn</p>
							</div>
						</div>
						<div class="h-right">
							<span
								class="h-cal"
								style="color: var(--accent-green)"
								>-240</span
							>
							<span
								class="h-edit"
								onclick="
									openEdit('Morning Run', '07:00 AM', '-240')
								"
								><i class="fa-solid fa-pen"></i> Edit</span
							>
						</div>
					</div>

					<!-- Item 4 -->
					<div class="history-item">
						<div class="h-left">
							<div class="h-time">
								<span>06</span>
								<span>AM</span>
							</div>
							<div class="h-info">
								<h4>Hydration</h4>
								<p>Water intake</p>
							</div>
						</div>
						<div class="h-right">
							<span class="h-cal">+500ml</span>
							<span
								class="h-edit"
								onclick="openEdit('Hydration', '06:45 AM', '0')"
								><i class="fa-solid fa-pen"></i> Edit</span
							>
						</div>
					</div>

					<!-- Item 5 -->
					<div class="history-item">
						<div class="h-left">
							<div class="h-time">
								<span>06</span>
								<span>AM</span>
							</div>
							<div class="h-info">
								<h4>Sleep Summary</h4>
								<p>7h 25m, Restorative</p>
							</div>
						</div>
						<div class="h-right">
							<span class="h-cal">74</span>
							<span
								class="h-edit"
								onclick="
									openEdit('Sleep Summary', '06:20 AM', '74')
								"
								><i class="fa-solid fa-pen"></i> Edit</span
							>
						</div>
					</div>
				</div>
			</div>

			<!-- Floating Nav -->
			<div class="nav-floater">
				<a
					class="nav-link"
					href="Dashbaord.html"
					aria-label="Dashboard"
				>
					<i class="fa-solid fa-house nav-icon"></i>
				</a>
				<a class="nav-link" href="Planner.html" aria-label="Planner">
					<i class="fa-regular fa-calendar-days nav-icon"></i>
				</a>
				<a class="nav-fab" href="Capture.html" aria-label="Capture"
					><i class="fa-solid fa-plus"></i
				></a>
				<a
					class="nav-link"
					href="Analytics.html"
					aria-label="Analytics"
				>
					<i class="fa-solid fa-chart-simple nav-icon active"></i>
				</a>
				<a class="nav-link" href="Settings.html" aria-label="Settings">
					<i class="fa-regular fa-user nav-icon"></i>
				</a>
			</div>
		</div>

		<div class="modal" id="editModal">
			<div class="modal-card">
				<div class="modal-header">
					<div class="modal-title">Edit Entry</div>
					<button
						class="modal-close"
						onclick="closeModal('editModal')"
					>
						<i class="fa-solid fa-xmark"></i>
					</button>
				</div>
				<div
					style="
						display: flex;
						flex-direction: column;
						gap: 10px;
						font-size: 12px;
					"
				>
					<label
						>Item
						<input
							id="editName"
							type="text"
							style="
								width: 100%;
								padding: 10px;
								border-radius: 10px;
								border: 1px solid #e2e8f0;
								margin-top: 4px;
							"
						/>
					</label>
					<label
						>Time
						<input
							id="editTime"
							type="text"
							style="
								width: 100%;
								padding: 10px;
								border-radius: 10px;
								border: 1px solid #e2e8f0;
								margin-top: 4px;
							"
						/>
					</label>
					<label
						>Calories
						<input
							id="editCalories"
							type="number"
							style="
								width: 100%;
								padding: 10px;
								border-radius: 10px;
								border: 1px solid #e2e8f0;
								margin-top: 4px;
							"
						/>
					</label>
				</div>
				<div class="modal-actions">
					<button class="btn-primary" onclick="saveEdit()">
						Save
					</button>
					<button
						class="btn-secondary"
						onclick="closeModal('editModal')"
					>
						Cancel
					</button>
				</div>
			</div>
		</div>

		<div class="toast" id="toast">Saved</div>

		<script>
			let toastTimer;
			let selectedRange = "W";
			let selectedA = "calories";
			let selectedB = "sleep";
			let hasAnalyticsData = true;

			const chartData = {
				W: {
					labels: ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"],
					calories: [1800, 1950, 2100, 1700, 2250, 2050, 1900],
					protein: [110, 125, 118, 98, 135, 122, 114],
					carbs: [210, 190, 240, 160, 260, 215, 200],
					active: [480, 520, 610, 390, 720, 540, 500],
					hydration: [1600, 1800, 1400, 2100, 1900, 1750, 2000],
					sleep: [68, 74, 70, 62, 78, 72, 75],
					energy: [76, 80, 78, 70, 85, 82, 79],
					hrv: [32, 34, 29, 26, 38, 35, 33],
					steps: [6800, 7200, 9100, 5300, 10400, 8400, 7600],
					mood: [6, 7, 6, 5, 8, 7, 7],
				},
				M: {
					labels: ["Wk1", "Wk2", "Wk3", "Wk4"],
					calories: [18800, 19600, 18200, 20100],
					protein: [780, 840, 790, 860],
					carbs: [1380, 1460, 1320, 1500],
					active: [3500, 4100, 3700, 4300],
					hydration: [11800, 12300, 11500, 12900],
					sleep: [71, 74, 69, 76],
					energy: [78, 82, 76, 84],
					hrv: [31, 34, 28, 36],
					steps: [52000, 56800, 49000, 60200],
					mood: [6.5, 7.2, 6.4, 7.5],
				},
				"3M": {
					labels: ["Jan", "Feb", "Mar"],
					calories: [76500, 78200, 80100],
					protein: [3280, 3420, 3580],
					carbs: [5900, 6040, 6210],
					active: [15200, 16750, 17400],
					hydration: [46800, 48200, 50100],
					sleep: [70, 72, 75],
					energy: [77, 80, 83],
					hrv: [30, 33, 35],
					steps: [210000, 224000, 236000],
					mood: [6.7, 7.1, 7.4],
				},
			};

			const metricLabels = {
				calories: "Calorie Intake",
				protein: "Protein Intake",
				carbs: "Carb Intake",
				active: "Active Burn",
				hydration: "Hydration",
				sleep: "Sleep Quality",
				energy: "Energy Score",
				hrv: "HRV / Stress",
				steps: "Steps",
				mood: "Mood",
			};

			function openEdit(name, time, calories) {
				document.getElementById("editName").value = name;
				document.getElementById("editTime").value = time;
				document.getElementById("editCalories").value = calories;
				openModal("editModal");
			}

			function saveEdit() {
				showToast("Entry updated");
				closeModal("editModal");
			}

			function showToast(message) {
				const toast = document.getElementById("toast");
				toast.textContent = message;
				toast.classList.add("show");
				clearTimeout(toastTimer);
				toastTimer = setTimeout(
					() => toast.classList.remove("show"),
					1600,
				);
			}

			function setActiveRange(range) {
				selectedRange = range;
				document.querySelectorAll(".time-opt").forEach((opt) => {
					opt.classList.toggle("active", opt.dataset.range === range);
				});
				renderChart();
			}

			function renderChart() {
				const data = chartData[selectedRange];
				const primary = data[selectedA];
				const secondary = data[selectedB];
				const labels = data.labels;

				const allValues = primary.concat(secondary);
				let minVal = Math.min.apply(null, allValues);
				let maxVal = Math.max.apply(null, allValues);
				if (minVal === maxVal) {
					minVal -= 1;
					maxVal += 1;
				}

				const top = 15;
				const bottom = 135;
				const height = bottom - top;
				const width = 300;
				const step =
					labels.length > 1 ? width / (labels.length - 1) : width;

				const makePoints = (values) =>
					values
						.map((val, i) => {
							const ratio = (val - minVal) / (maxVal - minVal);
							const y = bottom - ratio * height;
							const x = i * step;
							return `${x},${y}`;
						})
						.join(" ");

				document
					.getElementById("linePrimary")
					.setAttribute("points", makePoints(primary));
				document
					.getElementById("lineSecondary")
					.setAttribute("points", makePoints(secondary));

				const axis = document.getElementById("xAxis");
				axis.innerHTML = labels
					.map((label) => `<span>${label}</span>`)
					.join("");
			}

			function applyEmptyState() {
				const emptyState = document.getElementById("emptyState");
				const sections = document.querySelectorAll("[data-section]");
				if (hasAnalyticsData) {
					if (emptyState) {
						emptyState.style.display = "none";
					}
					sections.forEach((section) => (section.style.display = ""));
					renderChart();
				} else {
					if (emptyState) {
						emptyState.style.display = "block";
					}
					sections.forEach(
						(section) => (section.style.display = "none"),
					);
				}
			}

			function enableDemoData() {
				hasAnalyticsData = true;
				safeStorageSet("analyticsEmpty", "0");
				applyEmptyState();
				showToast("Demo data loaded");
			}

			function safeStorageGet(key) {
				try {
					return localStorage.getItem(key);
				} catch (err) {
					return null;
				}
			}

			function safeStorageSet(key, value) {
				try {
					localStorage.setItem(key, value);
				} catch (err) {
					return;
				}
			}

			function closeAllMenus() {
				document
					.querySelectorAll(".metric-menu")
					.forEach((menu) => menu.classList.remove("show"));
			}

			document.querySelectorAll(".metric-pill").forEach((pill) => {
				pill.addEventListener("click", (event) => {
					event.stopPropagation();
					const slot = pill.dataset.slot;
					const menu = document.getElementById(
						slot === "a" ? "metricMenuA" : "metricMenuB",
					);
					const isOpen = menu.classList.contains("show");
					closeAllMenus();
					if (!isOpen) {
						menu.classList.add("show");
					}
				});
			});

			document.querySelectorAll(".metric-item").forEach((item) => {
				item.addEventListener("click", (event) => {
					event.stopPropagation();
					const metric = item.dataset.metric;
					const isPrimary = item.closest("#metricMenuA");
					if (isPrimary) {
						selectedA = metric;
						document.getElementById("metricNameA").textContent =
							metricLabels[metric];
					} else {
						selectedB = metric;
						document.getElementById("metricNameB").textContent =
							metricLabels[metric];
					}
					closeAllMenus();
					renderChart();
				});
			});

			document.addEventListener("click", () => {
				closeAllMenus();
			});

			document.querySelectorAll(".time-opt").forEach((opt) => {
				opt.addEventListener("click", () =>
					setActiveRange(opt.dataset.range),
				);
			});

			function openModal(id) {
				const modal = document.getElementById(id);
				if (modal) {
					modal.classList.add("active");
				}
			}

			function closeModal(id) {
				const modal = document.getElementById(id);
				if (modal) {
					modal.classList.remove("active");
				}
			}

			const emptyFlag = safeStorageGet("analyticsEmpty");
			hasAnalyticsData = emptyFlag === "0";
			applyEmptyState();
		</script>
	</body>
</html>
