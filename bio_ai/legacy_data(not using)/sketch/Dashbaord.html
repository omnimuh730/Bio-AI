<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Bio AI Dashboard</title>
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&family=Inter:wght@400;500;600&display=swap"
			rel="stylesheet"
		/>
		<link
			rel="stylesheet"
			href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
		/>

		<style>
			:root {
				/* Brand Colors - Asklepios Blue Scheme */
				--primary: #4b7bff;
				--primary-gradient: linear-gradient(
					135deg,
					#4b7bff 0%,
					#2563eb 100%
				);
				--accent-purple: #8b5cf6;
				--accent-green: #10b981;
				--accent-orange: #f59e0b; /* Warning/Stress color */

				/* UI Colors */
				--bg-body: #f2f5f9;
				--surface: #ffffff;
				--text-main: #1e293b;
				--text-secondary: #64748b;
				--border-light: #e2e8f0;

				/* Spacing & Radius */
				--radius-card: 24px;
				--radius-btn: 16px;
				--padding-std: 20px;
			}

			* {
				box-sizing: border-box;
				margin: 0;
				padding: 0;
				-webkit-tap-highlight-color: transparent;
			}

			body {
				font-family: "DM Sans", sans-serif;
				background-color: var(--bg-body);
				color: var(--text-main);
				display: flex;
				justify-content: center;
				min-height: 100vh;
			}

			/* Mobile Container Simulation */
			.app-container {
				width: 100%;
				max-width: 414px; /* iPhone Max width */
				background-color: var(--bg-body);
				position: relative;
				padding-bottom: 100px; /* Space for Nav */
				overflow-x: hidden;
				box-shadow: 0 0 50px rgba(0, 0, 0, 0.05);
			}

			/* --- Header Section --- */
			.header {
				padding: 24px 24px 10px 24px;
				display: flex;
				justify-content: space-between;
				align-items: center;
			}

			.user-greeting h1 {
				font-size: 22px;
				font-weight: 700;
				color: var(--text-main);
			}

			.user-greeting p {
				font-size: 14px;
				color: var(--text-secondary);
				margin-top: 4px;
				display: flex;
				align-items: center;
				gap: 6px;
			}

			.sync-badge {
				width: 8px;
				height: 8px;
				background-color: var(--accent-green);
				border-radius: 50%;
				box-shadow: 0 0 8px var(--accent-green);
				animation: pulse 2s infinite;
			}

			.profile-btn {
				width: 44px;
				height: 44px;
				background-color: var(--surface);
				border-radius: 14px;
				display: flex;
				align-items: center;
				justify-content: center;
				box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
				font-size: 18px;
				color: var(--primary);
				position: relative;
			}

			.pending-badge {
				position: absolute;
				top: -4px;
				right: -4px;
				background: var(--accent-orange);
				color: white;
				font-size: 10px;
				font-weight: 700;
				padding: 2px 6px;
				border-radius: 12px;
				display: none;
			}

			/* --- Module A: Biological Status --- */
			.section-title {
				padding: 0 24px;
				margin-top: 20px;
				margin-bottom: 12px;
				font-size: 16px;
				font-weight: 600;
				color: var(--text-main);
				display: flex;
				justify-content: space-between;
			}

			.refresh-link {
				font-size: 13px;
				color: var(--primary);
				text-decoration: none;
				font-weight: 500;
			}

			.bio-grid {
				display: grid;
				grid-template-columns: 1fr 1fr;
				gap: 12px;
				padding: 0 24px;
			}

			.metric-card {
				background: var(--surface);
				border-radius: 20px;
				padding: 16px;
				display: flex;
				flex-direction: column;
				gap: 8px;
				box-shadow: 0 4px 6px rgba(0, 0, 0, 0.02);
			}

			.metric-header {
				display: flex;
				align-items: center;
				gap: 8px;
				font-size: 13px;
				color: var(--text-secondary);
				font-weight: 500;
			}

			.metric-value {
				font-size: 20px;
				font-weight: 700;
				color: var(--text-main);
			}

			.metric-sub {
				font-size: 11px;
				font-weight: 500;
			}

			/* State Colors */
			.color-stress {
				color: var(--accent-orange);
			} /* High HRV/Stress */
			.color-good {
				color: var(--accent-green);
			}
			.color-primary {
				color: var(--primary);
			}

			/* --- Module B: AI Recommendation (The Hero) --- */
			.ai-card {
				margin: 20px 24px;
				background: var(--surface);
				border-radius: var(--radius-card);
				padding: 24px;
				box-shadow: 0 10px 30px rgba(75, 123, 255, 0.1);
				position: relative;
				overflow: hidden;
				border: 1px solid rgba(75, 123, 255, 0.1);
			}

			/* Subtle background flourish */
			.ai-card::before {
				content: "";
				position: absolute;
				top: -20px;
				right: -20px;
				width: 100px;
				height: 100px;
				background: radial-gradient(
					circle,
					rgba(75, 123, 255, 0.1) 0%,
					rgba(255, 255, 255, 0) 70%
				);
				border-radius: 50%;
			}

			.ai-header {
				display: flex;
				justify-content: space-between;
				align-items: center;
				margin-bottom: 16px;
			}

			.ai-head-actions {
				display: flex;
				align-items: center;
				gap: 8px;
			}

			.ai-refresh {
				width: 28px;
				height: 28px;
				border-radius: 10px;
				border: none;
				background: #f1f5f9;
				color: var(--text-secondary);
				font-size: 13px;
				cursor: pointer;
			}

			.ai-badge {
				background-color: rgba(245, 158, 11, 0.1);
				color: var(--accent-orange);
				padding: 6px 12px;
				border-radius: 20px;
				font-size: 11px;
				font-weight: 700;
				display: flex;
				align-items: center;
				gap: 6px;
			}

			.meal-content {
				display: flex;
				gap: 16px;
				align-items: center;
			}

			.meal-img {
				width: 70px;
				height: 70px;
				border-radius: 50%;
				background-color: #eee;
				object-fit: cover;
				flex-shrink: 0;
			}

			.meal-info h3 {
				font-size: 18px;
				font-weight: 700;
				margin-bottom: 4px;
			}

			.meal-macros {
				font-size: 13px;
				color: var(--text-secondary);
				margin-bottom: 8px;
			}

			/* The "Why" Accordion */
			details.why-toggle {
				margin-top: 12px;
				background: #f8fafc;
				border-radius: 12px;
				padding: 10px 12px;
				font-size: 13px;
				color: var(--text-secondary);
				cursor: pointer;
				transition: 0.3s;
			}

			details.why-toggle[open] {
				background: #eef2ff;
				color: var(--primary);
			}

			summary {
				font-weight: 600;
				list-style: none;
				display: flex;
				align-items: center;
				gap: 6px;
			}

			summary::-webkit-details-marker {
				display: none;
			}

			.why-text {
				margin-top: 8px;
				line-height: 1.4;
				font-size: 12px;
			}

			.ai-actions {
				margin-top: 20px;
				display: flex;
				gap: 12px;
			}

			.ai-skeleton {
				display: none;
			}

			.ai-card.loading .ai-content {
				display: none;
			}

			.ai-card.loading .ai-skeleton {
				display: block;
			}

			.skeleton-line {
				height: 12px;
				border-radius: 8px;
				background: linear-gradient(
					90deg,
					#e2e8f0 0%,
					#f8fafc 50%,
					#e2e8f0 100%
				);
				background-size: 200% 100%;
				animation: shimmer 1.2s infinite;
				margin-bottom: 10px;
			}

			.skeleton-title {
				height: 16px;
				width: 70%;
			}
			.skeleton-sub {
				height: 12px;
				width: 50%;
			}
			.skeleton-block {
				height: 48px;
				border-radius: 16px;
				margin-top: 16px;
			}

			.btn-log {
				flex: 1;
				background: var(--primary-gradient);
				color: white;
				border: none;
				padding: 14px;
				border-radius: var(--radius-btn);
				font-weight: 600;
				font-size: 15px;
				display: flex;
				align-items: center;
				justify-content: center;
				gap: 8px;
				box-shadow: 0 4px 12px rgba(75, 123, 255, 0.3);
				cursor: pointer;
			}

			.btn-swap {
				width: 48px;
				background: #f1f5f9;
				border: none;
				border-radius: var(--radius-btn);
				color: var(--text-secondary);
				font-size: 16px;
				cursor: pointer;
			}

			/* --- Module C: Progress (ACCESSIBLE FIX) --- */
			.progress-card {
				margin: 0 24px;
				background: var(--surface);
				border-radius: var(--radius-card);
				padding: 24px 20px; /* More breathing room */
				display: flex;
				align-items: center; /* Vertically center the left and right sides */
				justify-content: space-between;
				gap: 20px;
				box-shadow: 0 4px 6px rgba(0, 0, 0, 0.02);
			}

			/* Left side container (Ring + Badge) */
			.gauge-container {
				display: flex;
				flex-direction: column;
				align-items: center;
				gap: 12px; /* Space between ring and badge */
				width: 110px; /* Fixed width to prevent shifting */
			}

			/* The Ring Wrapper */
			.cal-ring {
				position: relative;
				width: 100px;
				height: 100px;
				display: flex;
				align-items: center;
				justify-content: center;
			}

			/* SVG Config */
			.ring-svg {
				position: absolute;
				top: 0;
				left: 0;
				width: 100px;
				height: 100px;
				transform: rotate(-90deg); /* Start from top */
			}

			/* INNER RING (Calories - Thick & Blue) */
			.ring-circle-bg {
				fill: none;
				stroke: #f1f5f9;
				stroke-width: 8;
			}
			.ring-circle-val {
				fill: none;
				stroke: var(--primary);
				stroke-width: 8;
				stroke-dasharray: 201; /* 2 * PI * 32 */
				stroke-dashoffset: 40;
				stroke-linecap: round;
			}

			/* OUTER RING (Fasting - Thin & Subtle) */
			.ring-circle-fast-bg {
				fill: none;
				stroke: transparent; /* Hide empty track to reduce noise */
			}
			.ring-circle-fast-val {
				fill: none;
				stroke: var(--accent-green);
				stroke-width: 4;
				stroke-dasharray: 289; /* 2 * PI * 46 */
				stroke-dashoffset: 0;
				stroke-linecap: round;
				opacity: 0.8;
			}

			/* Text Inside Ring */
			.ring-text {
				position: absolute;
				z-index: 10;
				display: flex;
				flex-direction: column;
				align-items: center;
				justify-content: center;
			}
			.cal-number {
				font-weight: 800;
				font-size: 20px;
				color: var(--text-main);
				line-height: 1;
				letter-spacing: -0.5px;
			}
			.cal-label {
				font-size: 11px;
				color: var(--text-secondary);
				font-weight: 600;
				text-transform: uppercase;
				margin-top: 2px;
			}

			/* NEW: Badge Below Ring */
			.fasting-status {
				background: #f0fdf4; /* Light Green Bg */
				padding: 4px 10px;
				border-radius: 12px;
				display: flex;
				align-items: center;
				gap: 6px;
				border: 1px solid #dcfce7;
			}

			/* Dynamic colors for the badge */
			.fasting-status.eating {
				background: #f0fdf4;
				border-color: #dcfce7;
			}
			.fasting-status.fasting {
				background: #f8fafc;
				border-color: #e2e8f0;
			}

			.fasting-status .dot {
				width: 6px;
				height: 6px;
				border-radius: 50%;
				background: var(--accent-green);
			}

			.fasting-status span {
				font-size: 10px;
				font-weight: 700;
				color: #166534; /* Dark Green Text */
				text-transform: uppercase;
				letter-spacing: 0.5px;
			}

			/* Right Side Macros */
			.macros-list {
				flex: 1;
				display: flex;
				flex-direction: column;
				gap: 14px;
			}

			.macro-item {
				display: flex;
				flex-direction: column;
				gap: 6px;
			}

			.macro-labels {
				display: flex;
				justify-content: space-between;
				font-size: 12px;
				font-weight: 600;
				color: var(--text-secondary);
			}

			.progress-bar-bg {
				width: 100%;
				height: 8px; /* Slightly thicker for better visibility */
				background: #f1f5f9;
				border-radius: 10px;
				overflow: hidden;
			}
			.progress-fill {
				height: 100%;
				border-radius: 10px;
			}
			.fill-p {
				width: 60%;
				background: var(--accent-purple);
			}
			.fill-c {
				width: 80%;
				background: var(--accent-green);
			}
			.fill-f {
				width: 40%;
				background: var(--accent-orange);
			}

			/* REPLACE THIS SECTION IN YOUR CSS */

			.cal-ring {
				position: relative;
				width: 100px; /* Slightly larger container */
				height: 100px;
				display: flex;
				align-items: center;
				justify-content: center;
				flex-shrink: 0;
			}

			/* Base configuration for SVGs */
			.ring-svg {
				position: absolute;
				top: 0;
				left: 0;
				transform: rotate(-90deg);
				width: 100px;
				height: 100px;
			}

			/* INNER RING (Calories - The Fuel Tank) */
			/* Made smaller (r=32) so it sits inside clearly */
			.ring-circle-bg {
				fill: none;
				stroke: #f1f5f9;
				stroke-width: 8; /* Thicker track */
			}
			.ring-circle-val {
				fill: none;
				stroke: var(--primary);
				stroke-width: 8; /* Thicker value */
				stroke-dasharray: 201; /* 2 * PI * 32 */
				stroke-dashoffset: 40;
				stroke-linecap: round;
			}

			/* OUTER RING (Fasting - The Clock) */
			/* Made larger (r=46) to sit outside */
			.ring-circle-fast-bg {
				fill: none;
				stroke: rgba(148, 163, 184, 0.15);
				stroke-width: 3; /* Thin track */
			}
			.ring-circle-fast-val {
				fill: none;
				stroke: var(--accent-green);
				stroke-width: 3; /* Thin value */
				stroke-dasharray: 289; /* 2 * PI * 46 */
				stroke-dashoffset: 100;
				stroke-linecap: round;
				transition: stroke 0.3s ease;
			}

			/* TEXT CENTERING */
			.ring-text {
				position: absolute;
				text-align: center;
				z-index: 10;
				display: flex;
				flex-direction: column;
				align-items: center;
				justify-content: center;
			}

			.ring-text span {
				font-weight: 700;
				font-size: 18px;
				color: var(--text-main);
				line-height: 1;
			}

			.ring-text small {
				font-size: 10px;
				color: var(--text-secondary);
				text-transform: uppercase;
				margin-top: 2px;
			}

			.ring-text .fasting-label {
				font-size: 9px;
				color: var(--accent-green);
				font-weight: 600;
				margin-top: 4px;
				background: rgba(16, 185, 129, 0.1);
				padding: 2px 6px;
				border-radius: 8px;
			}

			.macros-list {
				flex: 1;
				margin-left: 20px;
				display: flex;
				flex-direction: column;
				gap: 12px;
			}

			.macro-item {
				display: flex;
				flex-direction: column;
				gap: 4px;
			}

			.macro-labels {
				display: flex;
				justify-content: space-between;
				font-size: 12px;
				font-weight: 500;
				color: var(--text-secondary);
			}

			.progress-bar-bg {
				width: 100%;
				height: 6px;
				background: #f1f5f9;
				border-radius: 10px;
				overflow: hidden;
			}

			.progress-fill {
				height: 100%;
				border-radius: 10px;
			}
			.fill-p {
				width: 60%;
				background: var(--accent-purple);
			}
			.fill-c {
				width: 80%;
				background: var(--accent-green);
			}
			.fill-f {
				width: 40%;
				background: var(--accent-orange);
			}

			/* --- Module D: Hydration --- */
			.hydro-section {
				padding: 24px;
			}

			.hydro-card {
				background: #eff6ff; /* Very light blue */
				border-radius: var(--radius-card);
				padding: 20px;
				display: flex;
				justify-content: space-between;
				align-items: center;
				cursor: pointer;
			}

			.hydro-info {
				display: flex;
				align-items: center;
				gap: 12px;
			}

			.hydro-icon {
				font-size: 24px;
				color: var(--primary);
			}

			.hydro-btns {
				display: flex;
				gap: 8px;
			}

			.impact-row {
				display: flex;
				gap: 8px;
				margin-top: 10px;
			}

			.impact-btn {
				border: none;
				background: rgba(255, 255, 255, 0.7);
				padding: 6px 10px;
				border-radius: 10px;
				font-size: 11px;
				font-weight: 700;
				color: var(--text-main);
				cursor: pointer;
				display: inline-flex;
				align-items: center;
				gap: 6px;
			}

			.impact-btn.caffeine {
				color: #b45309;
			}
			.impact-btn.alcohol {
				color: #7c3aed;
			}

			.impact-btn.active {
				background: var(--text-main);
				color: white;
			}

			.impact-note {
				margin-top: 6px;
				font-size: 11px;
				color: var(--text-secondary);
			}

			.btn-add-water {
				background: white;
				border: 1px solid rgba(255, 255, 255, 0.5);
				padding: 8px 12px;
				border-radius: 12px;
				font-size: 12px;
				font-weight: 600;
				color: var(--primary);
				box-shadow: 0 2px 4px rgba(75, 123, 255, 0.1);
				cursor: pointer;
			}

			/* --- Floating Navigation (From Image 1) --- */
			.nav-floater {
				position: fixed;
				bottom: 30px;
				left: 50%;
				transform: translateX(-50%);
				background: rgba(255, 255, 255, 0.9);
				backdrop-filter: blur(16px);
				-webkit-backdrop-filter: blur(16px);
				padding: 10px 24px;
				border-radius: 40px;
				box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
				display: flex;
				align-items: center;
				gap: 30px;
				z-index: 100;
				width: 85%;
				max-width: 360px;
				justify-content: space-between;
				border: 1px solid rgba(255, 255, 255, 0.5);
			}

			.nav-icon {
				font-size: 20px;
				color: var(--text-secondary);
				cursor: pointer;
				transition: 0.2s;
			}

			.nav-icon.active {
				color: var(--text-main);
			}

			.nav-fab {
				width: 50px;
				height: 50px;
				background: var(--text-main); /* Dark Button */
				border-radius: 50%;
				display: flex;
				align-items: center;
				justify-content: center;
				color: white;
				font-size: 20px;
				margin-top: -20px; /* Pop out effect */
				box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
				cursor: pointer;
				border: 4px solid var(--bg-body); /* Cutout effect */
				text-decoration: none;
			}

			.nav-fab.active {
				background: var(--primary);
				box-shadow: 0 8px 20px rgba(37, 99, 235, 0.35);
			}

			.nav-link {
				text-decoration: none;
				display: flex;
				align-items: center;
				justify-content: center;
			}

			/* --- Setup Card --- */
			.setup-card {
				margin: 12px 24px 0;
				background: linear-gradient(120deg, #eef2ff 0%, #f8fafc 100%);
				border-radius: 20px;
				padding: 16px;
				display: flex;
				gap: 12px;
				align-items: center;
				border: 1px solid #e2e8f0;
			}

			.setup-card h2 {
				font-size: 16px;
				margin-bottom: 6px;
			}

			.setup-card p {
				font-size: 12px;
				color: var(--text-secondary);
			}

			.setup-btn {
				background: var(--text-main);
				color: white;
				padding: 10px 14px;
				border-radius: 14px;
				font-size: 12px;
				text-decoration: none;
				font-weight: 600;
				white-space: nowrap;
			}

			/* --- Quick Log --- */
			.quicklog-card {
				margin: 0 24px;
				background: var(--surface);
				border-radius: 20px;
				padding: 16px;
				display: flex;
				align-items: center;
				justify-content: space-between;
				gap: 12px;
				box-shadow: 0 4px 10px rgba(0, 0, 0, 0.02);
			}

			.quicklog-info h4 {
				font-size: 15px;
				margin-bottom: 4px;
			}

			.quicklog-info p {
				font-size: 12px;
				color: var(--text-secondary);
			}

			.btn-quicklog {
				border: none;
				background: #f1f5f9;
				color: var(--text-main);
				padding: 10px 12px;
				border-radius: 12px;
				font-size: 12px;
				font-weight: 600;
				cursor: pointer;
			}

			/* --- Toast --- */
			.toast {
				position: fixed;
				bottom: 110px;
				left: 50%;
				transform: translateX(-50%);
				background: rgba(15, 23, 42, 0.9);
				color: white;
				padding: 10px 16px;
				border-radius: 12px;
				font-size: 12px;
				opacity: 0;
				pointer-events: none;
				transition: opacity 0.2s ease;
				z-index: 220;
			}

			.toast.show {
				opacity: 1;
			}
			.toast.success {
				background: rgba(16, 185, 129, 0.95);
			}

			/* --- Modal --- */
			.modal {
				position: fixed;
				inset: 0;
				background: rgba(15, 23, 42, 0.4);
				display: flex;
				align-items: center;
				justify-content: center;
				padding: 24px;
				opacity: 0;
				pointer-events: none;
				transition: opacity 0.2s ease;
				z-index: 200;
			}

			.modal.active {
				opacity: 1;
				pointer-events: auto;
			}

			.modal-card {
				width: 100%;
				max-width: 360px;
				background: var(--surface);
				border-radius: 20px;
				padding: 20px;
				box-shadow: 0 20px 40px rgba(15, 23, 42, 0.2);
			}

			.modal-header {
				display: flex;
				justify-content: space-between;
				align-items: center;
				margin-bottom: 12px;
			}

			.modal-title {
				font-size: 16px;
				font-weight: 700;
			}

			.modal-close {
				border: none;
				background: #f1f5f9;
				width: 32px;
				height: 32px;
				border-radius: 10px;
				cursor: pointer;
			}

			.modal-list {
				display: flex;
				flex-direction: column;
				gap: 10px;
				font-size: 12px;
				color: var(--text-secondary);
			}

			.modal-list strong {
				color: var(--text-main);
			}

			.modal-actions {
				display: flex;
				gap: 10px;
				margin-top: 16px;
			}

			.btn-primary {
				flex: 1;
				background: var(--primary-gradient);
				color: white;
				border: none;
				padding: 12px;
				border-radius: 12px;
				font-weight: 600;
				cursor: pointer;
				text-align: center;
				text-decoration: none;
			}

			.btn-secondary {
				flex: 1;
				background: #f1f5f9;
				color: var(--text-main);
				border: none;
				padding: 12px;
				border-radius: 12px;
				font-weight: 600;
				cursor: pointer;
			}

			.modal-input {
				width: 100%;
				margin-top: 10px;
				border: 1px solid var(--border-light);
				border-radius: 12px;
				padding: 10px 12px;
				font-size: 13px;
				font-family: inherit;
			}

			/* Bottom Sheet */
			.sheet {
				position: fixed;
				inset: 0;
				display: flex;
				align-items: flex-end;
				justify-content: center;
				background: rgba(15, 23, 42, 0.4);
				opacity: 0;
				pointer-events: none;
				transition: opacity 0.2s ease;
				z-index: 210;
			}

			.sheet.active {
				opacity: 1;
				pointer-events: auto;
			}

			.sheet-card {
				width: 100%;
				max-width: 414px;
				background: var(--surface);
				border-radius: 24px 24px 0 0;
				padding: 16px 24px 28px;
				box-shadow: 0 -20px 40px rgba(15, 23, 42, 0.2);
			}

			.sheet-handle {
				width: 40px;
				height: 4px;
				background: #cbd5e1;
				border-radius: 10px;
				margin: 0 auto 12px;
			}

			.sheet-title {
				font-size: 15px;
				font-weight: 700;
				margin-bottom: 12px;
			}

			.sheet-option {
				padding: 12px;
				border-radius: 14px;
				background: #f8fafc;
				font-size: 13px;
				font-weight: 600;
				color: var(--text-main);
				margin-bottom: 10px;
				cursor: pointer;
			}

			.sheet-option span {
				display: block;
				font-size: 11px;
				font-weight: 500;
				color: var(--text-secondary);
				margin-top: 4px;
			}

			/* Animations */
			@keyframes pulse {
				0% {
					box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.4);
				}
				70% {
					box-shadow: 0 0 0 6px rgba(16, 185, 129, 0);
				}
				100% {
					box-shadow: 0 0 0 0 rgba(16, 185, 129, 0);
				}
			}

			@keyframes shimmer {
				0% {
					background-position: 200% 0;
				}
				100% {
					background-position: -200% 0;
				}
			}
		</style>
	</head>
	<body>
		<div class="app-container">
			<!-- Header -->
			<header class="header">
				<div class="user-greeting">
					<p><span class="sync-badge"></span> Bio-Sync Active</p>
					<h1>Hello, Dekomori</h1>
				</div>
				<div
					class="profile-btn"
					onclick="openModal('notifyModal')"
					title="Notifications"
				>
					<i class="fa-regular fa-bell"></i>
					<span class="pending-badge" id="pendingBadge">1</span>
				</div>
			</header>

			<div class="setup-card">
				<div>
					<h2>Finish your setup</h2>
					<p>
						Complete profile, dietary rules, and device sync to
						unlock adaptive plans.
					</p>
				</div>
				<a class="setup-btn" href="Onboarding.html">Continue</a>
			</div>

			<!-- Module A: Bio Status -->
			<div class="section-title">
				<span>Live Vitals</span>
				<a
					href="#"
					class="refresh-link"
					onclick="
						syncVitals();
						return false;
					"
					><i class="fa-solid fa-rotate-right"></i> Refresh</a
				>
			</div>

			<div class="bio-grid">
				<!-- Card 1: Heart Rate -->
				<div class="metric-card">
					<div class="metric-header">
						<i class="fa-solid fa-heart-pulse color-primary"></i>
						Heart Rate
					</div>
					<div class="metric-value">
						72
						<span
							style="
								font-size: 14px;
								font-weight: 400;
								color: #94a3b8;
							"
							>bpm</span
						>
					</div>
					<div class="metric-sub color-good">Normal Resting</div>
				</div>

				<!-- Card 2: Stress / HRV -->
				<div class="metric-card">
					<div class="metric-header">
						<i class="fa-solid fa-brain color-stress"></i> Stress
						(HRV)
					</div>
					<div class="metric-value">
						28
						<span
							style="
								font-size: 14px;
								font-weight: 400;
								color: #94a3b8;
							"
							>ms</span
						>
					</div>
					<div class="metric-sub color-stress">High Stress</div>
				</div>

				<!-- Card 3: Sleep -->
				<div class="metric-card">
					<div class="metric-header">
						<i class="fa-solid fa-moon color-primary"></i> Sleep
						Score
					</div>
					<div class="metric-value">
						64
						<span
							style="
								font-size: 14px;
								font-weight: 400;
								color: #94a3b8;
							"
							>/100</span
						>
					</div>
					<div class="metric-sub" style="color: #f59e0b">
						Suboptimal
					</div>
				</div>

				<!-- Card 4: Steps -->
				<div class="metric-card">
					<div class="metric-header">
						<i class="fa-solid fa-person-walking color-primary"></i>
						Activity
					</div>
					<div class="metric-value">
						2.4k
						<span
							style="
								font-size: 14px;
								font-weight: 400;
								color: #94a3b8;
							"
							>steps</span
						>
					</div>
					<div class="metric-sub color-primary">On Track</div>
				</div>
			</div>

			<!-- Module B: AI Recommendation -->
			<div class="section-title">
				<span>AI Suggestion</span>
			</div>

			<div class="ai-card" id="aiCard">
				<div class="ai-header">
					<span
						id="mealTime"
						style="
							font-size: 12px;
							font-weight: 600;
							color: var(--text-secondary);
						"
						>LUNCH - 12:30 PM</span
					>
					<div class="ai-head-actions">
						<button
							class="ai-refresh"
							onclick="openSwapSheet()"
							title="Why swap?"
						>
							<i class="fa-solid fa-rotate-right"></i>
						</button>
						<div class="ai-badge" id="mealBadge">
							<i class="fa-solid fa-bolt"></i> Anti-Stress
						</div>
					</div>
				</div>

				<div class="ai-content">
					<div class="meal-content">
						<!-- Placeholder image for food -->
						<img
							id="mealImage"
							src="https://images.unsplash.com/photo-1546069901-ba9599a7e63c?ixlib=rb-4.0.3&auto=format&fit=crop&w=100&q=80"
							alt="Bowl"
							class="meal-img"
						/>
						<div class="meal-info">
							<h3 id="mealTitle">Magnesium Power Bowl</h3>
							<div class="meal-macros" id="mealMacros">
								450 kcal - 22g Protein - GF
							</div>
						</div>
					</div>

					<!-- The "Why" Engine -->
					<details class="why-toggle">
						<summary>
							<i class="fa-solid fa-wand-magic-sparkles"></i> Why
							this?
						</summary>
						<p class="why-text" id="mealWhy">
							Your HRV is low (High Stress). We swapped your usual
							espresso for a quinoa and avocado bowl rich in
							magnesium to help lower cortisol levels.
						</p>
					</details>

					<div class="ai-actions">
						<button
							class="btn-swap"
							onclick="swapMeal()"
							title="Swap meal"
						>
							<i class="fa-solid fa-rotate"></i>
						</button>
						<button class="btn-log" onclick="logMeal()">
							<i class="fa-solid fa-plus"></i> Eat This (<span
								id="mealCals"
								>450</span
							>
							kcal)
						</button>
					</div>
				</div>

				<div class="ai-skeleton">
					<div class="skeleton-line skeleton-title"></div>
					<div class="skeleton-line skeleton-sub"></div>
					<div class="skeleton-line skeleton-block"></div>
					<div class="skeleton-line"></div>
					<div class="skeleton-line skeleton-sub"></div>
				</div>
			</div>

			<!-- Module C: Daily Progress -->
			<div class="section-title">
				<span>Daily Fuel</span>
			</div>

			<div class="progress-card">
				<!-- SVG Ring -->
				<!-- REPLACE THE SVG BLOCK IN HTML -->
				<div class="cal-ring">
					<!-- Outer Ring (Fasting Timer): Radius 46 -->
					<svg class="ring-svg" viewBox="0 0 100 100">
						<circle
							cx="50"
							cy="50"
							r="46"
							class="ring-circle-fast-bg"
						></circle>
						<circle
							cx="50"
							cy="50"
							r="46"
							class="ring-circle-fast-val"
							id="fastingRing"
						></circle>
					</svg>

					<!-- Inner Ring (Calorie Fuel): Radius 32 -->
					<svg class="ring-svg inner" viewBox="0 0 100 100">
						<circle
							cx="50"
							cy="50"
							r="32"
							class="ring-circle-bg"
						></circle>
						<circle
							cx="50"
							cy="50"
							r="32"
							class="ring-circle-val"
						></circle>
					</svg>

					<div class="ring-text">
						<span>1,240</span>
						<small>Left</small>
						<!-- The badge is now inside the ring but styled cleanly -->
						<small class="fasting-label" id="fastingLabel"
							>Eating</small
						>
					</div>
				</div>

				<div class="macros-list">
					<!-- Protein -->
					<div class="macro-item">
						<div class="macro-labels">
							<span>Protein</span>
							<span>80g / 140g</span>
						</div>
						<div class="progress-bar-bg">
							<div class="progress-fill fill-p"></div>
						</div>
					</div>
					<!-- Carbs -->
					<div class="macro-item">
						<div class="macro-labels">
							<span>Carbs</span>
							<span>120g / 200g</span>
						</div>
						<div class="progress-bar-bg">
							<div class="progress-fill fill-c"></div>
						</div>
					</div>
					<!-- Fat -->
					<div class="macro-item">
						<div class="macro-labels">
							<span>Fat</span>
							<span>30g / 70g</span>
						</div>
						<div class="progress-bar-bg">
							<div class="progress-fill fill-f"></div>
						</div>
					</div>
				</div>
			</div>

			<!-- Module D: Hydration -->
			<div class="section-title">
				<span>Hydration</span>
			</div>

			<div class="hydro-section">
				<div class="hydro-card" onclick="openHydrationModal()">
					<div class="hydro-info">
						<i class="fa-solid fa-glass-water hydro-icon"></i>
						<div>
							<h4 style="font-size: 16px">1,250ml</h4>
							<span
								style="
									font-size: 12px;
									color: var(--text-secondary);
								"
								>Goal: 2,500ml</span
							>
							<div class="impact-row">
								<button
									class="impact-btn caffeine"
									id="caffeineBtn"
									onclick="
										event.stopPropagation();
										logImpact('caffeine');
									"
								>
									<i class="fa-solid fa-mug-hot"></i> Caffeine
								</button>
								<button
									class="impact-btn alcohol"
									id="alcoholBtn"
									onclick="
										event.stopPropagation();
										logImpact('alcohol');
									"
								>
									<i class="fa-solid fa-wine-glass"></i>
									Alcohol
								</button>
							</div>
							<div class="impact-note">
								Caffeine and alcohol do not count toward
								hydration.
							</div>
						</div>
					</div>
					<div class="hydro-btns">
						<button
							class="btn-add-water"
							onclick="
								event.stopPropagation();
								addHydration(250);
							"
						>
							+250
						</button>
						<button
							class="btn-add-water"
							onclick="
								event.stopPropagation();
								addHydration(500);
							"
						>
							+500
						</button>
					</div>
				</div>
			</div>

			<div class="section-title">
				<span>Quick Log</span>
				<a href="Analytics.html" class="refresh-link">View History</a>
			</div>

			<div class="quicklog-card">
				<div class="quicklog-info">
					<h4>Copy Yesterday Breakfast</h4>
					<p>Oatmeal and berries - 320 kcal</p>
				</div>
				<button class="btn-quicklog" onclick="quickLog()">Copy</button>
			</div>

			<!-- Floating Nav (Image 1 Style) -->
			<div class="nav-floater">
				<a
					class="nav-link"
					href="Dashbaord.html"
					aria-label="Dashboard"
				>
					<i class="fa-solid fa-house nav-icon active"></i>
				</a>
				<a class="nav-link" href="Planner.html" aria-label="Planner">
					<i class="fa-regular fa-calendar-days nav-icon"></i>
				</a>

				<!-- Central AI Action Button -->
				<a class="nav-fab" href="Capture.html" aria-label="Capture">
					<i class="fa-solid fa-plus"></i>
				</a>

				<a
					class="nav-link"
					href="Analytics.html"
					aria-label="Analytics"
				>
					<i class="fa-solid fa-chart-simple nav-icon"></i>
				</a>
				<a class="nav-link" href="Settings.html" aria-label="Settings">
					<i class="fa-regular fa-user nav-icon"></i>
				</a>
			</div>
		</div>

		<div class="toast" id="toast">Saved</div>

		<div class="modal" id="notifyModal">
			<div class="modal-card">
				<div class="modal-header">
					<div class="modal-title">Notifications</div>
					<button
						class="modal-close"
						onclick="closeModal('notifyModal')"
					>
						<i class="fa-solid fa-xmark"></i>
					</button>
				</div>
				<div class="modal-list">
					<div>
						<strong>High Stress</strong> detected at 10:05 AM. Try a
						magnesium-rich snack.
					</div>
					<div>
						<strong>Hydration</strong> reminder: 1,250 ml left to
						hit goal.
					</div>
					<div>
						<strong>Device Sync</strong> completed 2 minutes ago.
					</div>
					<div id="pendingUploadRow" style="display: none">
						<strong>Pending Uploads</strong>
						<span id="pendingUploadText"
							>2 photos waiting for Wi-Fi.</span
						>
					</div>
				</div>
				<div
					class="modal-actions"
					id="pendingActions"
					style="display: none"
				>
					<button
						class="btn-primary"
						onclick="processPendingUploads()"
					>
						Process Uploads
					</button>
					<button
						class="btn-secondary"
						onclick="closeModal('notifyModal')"
					>
						Close
					</button>
				</div>
			</div>
		</div>

		<div class="modal" id="logModal">
			<div class="modal-card">
				<div class="modal-header">
					<div class="modal-title">Meal Logged</div>
					<button
						class="modal-close"
						onclick="closeModal('logModal')"
					>
						<i class="fa-solid fa-xmark"></i>
					</button>
				</div>
				<div class="modal-list">
					<div>
						<strong id="loggedMealTitle"
							>Magnesium Power Bowl</strong
						>
					</div>
					<div>Macros added to your daily totals.</div>
				</div>
				<div class="modal-actions">
					<a class="btn-primary" href="Analytics.html">View Diary</a>
					<button
						class="btn-secondary"
						onclick="closeModal('logModal')"
					>
						Keep Browsing
					</button>
				</div>
			</div>
		</div>

		<div class="modal" id="hydrationModal">
			<div class="modal-card">
				<div class="modal-header">
					<div class="modal-title">Log Hydration</div>
					<button
						class="modal-close"
						onclick="closeModal('hydrationModal')"
					>
						<i class="fa-solid fa-xmark"></i>
					</button>
				</div>
				<div class="modal-list">
					<div><strong>Custom Amount</strong></div>
					<div>Enter your water intake in ml.</div>
					<input
						class="modal-input"
						id="hydrationInput"
						type="number"
						min="1"
						placeholder="e.g. 140"
					/>
				</div>
				<div class="modal-actions">
					<button class="btn-primary" onclick="confirmHydration()">
						Confirm
					</button>
					<button
						class="btn-secondary"
						onclick="closeModal('hydrationModal')"
					>
						Cancel
					</button>
				</div>
			</div>
		</div>

		<div class="sheet" id="swapSheet" onclick="closeSwapSheet(event)">
			<div class="sheet-card">
				<div class="sheet-handle"></div>
				<div class="sheet-title">Why swap this meal?</div>
				<div
					class="sheet-option"
					onclick="applySwapReason('ingredients')"
				>
					Don't have ingredients
					<span>Find a recipe with pantry-ready items.</span>
				</div>
				<div class="sheet-option" onclick="applySwapReason('cost')">
					Too expensive
					<span>Suggest a lower-cost alternative.</span>
				</div>
				<div class="sheet-option" onclick="applySwapReason('taste')">
					Don't like the taste
					<span>Swap to a different flavor profile.</span>
				</div>
				<div
					class="sheet-option"
					onclick="applySwapReason('not-hungry')"
				>
					Just not hungry
					<span>Offer a lighter option.</span>
				</div>
			</div>
		</div>

		<script>
			const meals = [
				{
					id: "anti-stress-lunch",
					time: "LUNCH - 12:30 PM",
					badge: "Anti-Stress",
					title: "Magnesium Power Bowl",
					macros: "450 kcal - 22g Protein - GF",
					cals: 450,
					why: "Your HRV is low (High Stress). We swapped your usual espresso for a quinoa and avocado bowl rich in magnesium to help lower cortisol levels.",
					image: "https://images.unsplash.com/photo-1546069901-ba9599a7e63c?ixlib=rb-4.0.3&auto=format&fit=crop&w=100&q=80",
				},
				{
					id: "energy-snack",
					time: "SNACK - 3:10 PM",
					badge: "Energy Boost",
					title: "Berry Oat Yogurt",
					macros: "280 kcal - 18g Protein - High Fiber",
					cals: 280,
					why: "Sleep score dipped below 60. This snack adds slow carbs and potassium to stabilize energy.",
					image: "https://images.unsplash.com/photo-1490474418585-ba9bad8fd0ea?ixlib=rb-4.0.3&auto=format&fit=crop&w=100&q=80",
				},
				{
					id: "recovery-dinner",
					time: "DINNER - 7:00 PM",
					badge: "Recovery",
					title: "Salmon and Sweet Potato",
					macros: "520 kcal - 34g Protein - Omega 3",
					cals: 520,
					why: "High activity detected today. This dinner boosts glycogen recovery and supports muscle repair.",
					image: "https://images.unsplash.com/photo-1504674900247-0877df9cc836?ixlib=rb-4.0.3&auto=format&fit=crop&w=100&q=80",
				},
				{
					id: "heavy-lunch",
					time: "LUNCH - 1:05 PM",
					badge: "High Fuel",
					title: "Double Smash Burger",
					macros: "1,120 kcal - 48g Protein - High Fat",
					cals: 1120,
					why: "You are craving a higher calorie meal. Logging this will trigger a re-balance for dinner.",
					image: "https://images.unsplash.com/photo-1550547660-d9450f859349?ixlib=rb-4.0.3&auto=format&fit=crop&w=100&q=80",
				},
				{
					id: "rebalance-dinner",
					time: "DINNER - 7:20 PM",
					badge: "Re-Balance",
					title: "Light Salmon Salad",
					macros: "380 kcal - 28g Protein - Low Carb",
					cals: 380,
					why: "Lunch was heavier than planned. This lighter dinner keeps you on track without spiking stress.",
					image: "https://images.unsplash.com/photo-1551183053-bf91a1d81141?ixlib=rb-4.0.3&auto=format&fit=crop&w=100&q=80",
				},
				{
					id: "sleep-support",
					time: "DINNER - 8:00 PM",
					badge: "Sleep Support",
					title: "Tart Cherry Recovery Bowl",
					macros: "420 kcal - 24g Protein - Magnesium",
					cals: 420,
					why: "Late caffeine logged. Tart cherry and magnesium help calm the nervous system before sleep.",
					image: "https://images.unsplash.com/photo-1478145046317-39f10e56b5e9?ixlib=rb-4.0.3&auto=format&fit=crop&w=100&q=80",
				},
				{
					id: "hydration-reset",
					time: "DINNER - 8:00 PM",
					badge: "Hydration Reset",
					title: "Citrus Protein Bowl",
					macros: "460 kcal - 30g Protein - Electrolytes",
					cals: 460,
					why: "Alcohol logged late. Extra electrolytes and protein support recovery.",
					image: "https://images.unsplash.com/photo-1540189549336-e6e99c3679fe?ixlib=rb-4.0.3&auto=format&fit=crop&w=100&q=80",
				},
			];

			const swapReasons = {
				ingredients:
					"Ingredients unavailable. Swapped to a pantry-ready meal.",
				cost: "Cost sensitive option selected. Swapped to a lower-cost meal.",
				taste: "Taste mismatch. Swapped to a different flavor profile.",
				"not-hungry": "Not hungry. Swapped to a lighter option.",
			};

			const fastingSchedule = { eatingStart: 12, eatingEnd: 20 };
			let mealIndex = 0;
			let toastTimer;
			let aiTimer;

			function updateMeal(meal) {
				const data = meal || meals[mealIndex];
				if (!data) {
					return;
				}
				document.getElementById("mealTime").textContent = data.time;
				document.getElementById("mealBadge").innerHTML =
					'<i class="fa-solid fa-bolt"></i> ' + data.badge;
				document.getElementById("mealTitle").textContent = data.title;
				document.getElementById("mealMacros").textContent = data.macros;
				document.getElementById("mealCals").textContent = data.cals;
				document.getElementById("mealWhy").textContent = data.why;
				document.getElementById("mealImage").src = data.image;
				document.getElementById("loggedMealTitle").textContent =
					data.title;
			}

			function setMealById(id) {
				const idx = meals.findIndex((meal) => meal.id === id);
				if (idx !== -1) {
					mealIndex = idx;
					updateMeal();
				}
			}

			function setAiLoading(isLoading) {
				const card = document.getElementById("aiCard");
				if (!card) {
					return;
				}
				card.classList.toggle("loading", isLoading);
			}

			function swapMeal(reason) {
				setAiLoading(true);
				clearTimeout(aiTimer);
				aiTimer = setTimeout(() => {
					mealIndex = (mealIndex + 1) % meals.length;
					updateMeal();
					if (reason && swapReasons[reason]) {
						document.getElementById("mealWhy").textContent =
							swapReasons[reason];
					}
					setAiLoading(false);
					showToast("New suggestion loaded");
				}, 650);
			}

			function openSwapSheet() {
				const sheet = document.getElementById("swapSheet");
				if (sheet) {
					sheet.classList.add("active");
				}
			}

			function closeSwapSheet(event) {
				if (
					event &&
					event.target &&
					!event.target.classList.contains("sheet")
				) {
					return;
				}
				const sheet = document.getElementById("swapSheet");
				if (sheet) {
					sheet.classList.remove("active");
				}
			}

			function applySwapReason(reason) {
				closeSwapSheet();
				swapMeal(reason);
			}

			function logMeal() {
				const currentMeal = meals[mealIndex];
				openModal("logModal");
				showToast("Ate this. Added to diary.", "success");
				vibrate("success");
				if (currentMeal && currentMeal.cals >= 800) {
					setTimeout(() => {
						showToast(
							"Lunch was higher than planned. Recalculating Dinner...",
						);
						setAiLoading(true);
						setTimeout(() => {
							setMealById("rebalance-dinner");
							setAiLoading(false);
						}, 700);
					}, 400);
				}
			}

			function syncVitals() {
				showToast("Vitals synced");
			}

			function quickLog() {
				showToast("Copied to diary");
				vibrate("success");
			}

			function addHydration(amount) {
				showToast("Added " + amount + "ml to hydration.", "success");
				vibrate("success");
			}

			function logImpact(type) {
				const now = new Date();
				const impactData = { type: type, time: now.getTime() };
				safeStorageSet("lastImpact", JSON.stringify(impactData));
				setImpactButton(type);
				if (type === "caffeine") {
					showToast(
						"Caffeine logged. Hydration unchanged.",
						"success",
					);
				} else {
					showToast(
						"Alcohol logged. Hydration unchanged.",
						"success",
					);
				}
				vibrate("success");
				if (now.getHours() >= 18) {
					showToast("Late log detected. Updating dinner...");
					setAiLoading(true);
					setTimeout(() => {
						setMealById(
							type === "caffeine"
								? "sleep-support"
								: "hydration-reset",
						);
						setAiLoading(false);
					}, 700);
				}
			}

			function setImpactButton(type) {
				const caffeineBtn = document.getElementById("caffeineBtn");
				const alcoholBtn = document.getElementById("alcoholBtn");
				if (caffeineBtn) {
					caffeineBtn.classList.toggle("active", type === "caffeine");
				}
				if (alcoholBtn) {
					alcoholBtn.classList.toggle("active", type === "alcohol");
				}
			}

			function openHydrationModal() {
				const input = document.getElementById("hydrationInput");
				if (input) {
					input.value = "";
				}
				openModal("hydrationModal");
			}

			function confirmHydration() {
				const input = document.getElementById("hydrationInput");
				const value = Number(input ? input.value : 0);
				if (!value) {
					showToast("Enter a hydration amount");
					return;
				}
				closeModal("hydrationModal");
				showToast("Added " + value + "ml to hydration.", "success");
				vibrate("success");
			}

			function updateFastingRing() {
				const ring = document.getElementById("fastingRing");
				const label = document.getElementById("fastingLabel");
				const badge = document.getElementById("fastingBadge"); // The container
				const dot = badge.querySelector(".dot"); // The color dot

				if (!ring || !label) return;

				const now = new Date();
				const hour = now.getHours() + now.getMinutes() / 60;

				// Config
				const eatingStart = fastingSchedule.eatingStart; // e.g., 12
				const eatingEnd = fastingSchedule.eatingEnd; // e.g., 20

				const isEating = hour >= eatingStart && hour < eatingEnd;

				// Calculate Progress (Visual only)
				// 252 is approx circumference of outer ring
				const circumference = 289;
				// Logic to fill ring based on time... (simplified for demo)
				ring.style.strokeDashoffset = isEating ? 0 : circumference;

				// VISUAL UPDATE
				if (isEating) {
					label.textContent = "Eating Window";
					label.style.color = "#15803d"; // Dark Green
					dot.style.background = "#22c55e";
					ring.style.stroke = "#22c55e";
					badge.style.background = "#f0fdf4";
					badge.style.borderColor = "#dcfce7";
				} else {
					label.textContent = "Fasting";
					label.style.color = "#64748b"; // Slate 500
					dot.style.background = "#94a3b8";
					ring.style.stroke = "#cbd5e1";
					badge.style.background = "#f8fafc";
					badge.style.borderColor = "#e2e8f0";
				}
			}

			function syncPendingUploads() {
				const badge = document.getElementById("pendingBadge");
				const row = document.getElementById("pendingUploadRow");
				const actions = document.getElementById("pendingActions");
				const text = document.getElementById("pendingUploadText");
				const count = Number(safeStorageGet("pendingUploads") || 0);
				if (badge) {
					badge.textContent = count;
					badge.style.display = count > 0 ? "inline-flex" : "none";
				}
				if (row && text && actions) {
					row.style.display = count > 0 ? "block" : "none";
					actions.style.display = count > 0 ? "flex" : "none";
					if (count > 0) {
						text.textContent =
							count +
							(count === 1
								? " photo waiting for Wi-Fi."
								: " photos waiting for Wi-Fi.");
					}
				}
			}

			function processPendingUploads() {
				showToast("Uploading pending photos...");
				setTimeout(() => {
					safeStorageSet("pendingUploads", "0");
					syncPendingUploads();
					showToast("Uploads processed", "success");
				}, 900);
			}

			function applyImpactFromStorage() {
				const raw = safeStorageGet("lastImpact");
				if (!raw) {
					return;
				}
				try {
					const impact = JSON.parse(raw);
					if (!impact || !impact.type || !impact.time) {
						return;
					}
					setImpactButton(impact.type);
					const impactTime = new Date(impact.time);
					if (impactTime.getHours() >= 18) {
						setMealById(
							impact.type === "caffeine"
								? "sleep-support"
								: "hydration-reset",
						);
					}
				} catch (err) {
					return;
				}
			}

			function showToast(message, type) {
				const toast = document.getElementById("toast");
				toast.textContent = message;
				toast.classList.remove("success");
				if (type === "success") {
					toast.classList.add("success");
				}
				toast.classList.add("show");
				clearTimeout(toastTimer);
				toastTimer = setTimeout(() => {
					toast.classList.remove("show");
					toast.classList.remove("success");
				}, 1600);
			}

			function vibrate(kind) {
				if (!navigator.vibrate) {
					return;
				}
				if (kind === "error") {
					navigator.vibrate([60, 40, 60]);
				} else {
					navigator.vibrate(25);
				}
			}

			function safeStorageGet(key) {
				try {
					return localStorage.getItem(key);
				} catch (err) {
					return null;
				}
			}

			function safeStorageSet(key, value) {
				try {
					localStorage.setItem(key, value);
				} catch (err) {
					return;
				}
			}

			function openModal(id) {
				const modal = document.getElementById(id);
				if (modal) {
					modal.classList.add("active");
				}
				if (id === "notifyModal") {
					syncPendingUploads();
				}
			}

			function closeModal(id) {
				const modal = document.getElementById(id);
				if (modal) {
					modal.classList.remove("active");
				}
			}

			updateMeal();
			updateFastingRing();
			syncPendingUploads();
			applyImpactFromStorage();
		</script>
	</body>
</html>
