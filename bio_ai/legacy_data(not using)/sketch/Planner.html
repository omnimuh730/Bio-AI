<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Bio AI - Planner</title>
		<link
			href="https://fonts.googleapis.com/css2-family=DM+Sans:wght@400;500;700&family=Inter:wght@400;500;600&display=swap"
			rel="stylesheet"
		/>
		<link
			rel="stylesheet"
			href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
		/>

		<style>
			:root {
				/* Brand Colors */
				--primary: #4b7bff;
				--primary-light: #eff6ff;
				--primary-gradient: linear-gradient(
					135deg,
					#4b7bff 0%,
					#2563eb 100%
				);
				--accent-green: #10b981;
				--accent-gold: #f59e0b;

				--bg-body: #f2f5f9;
				--surface: #ffffff;
				--text-main: #1e293b;
				--text-secondary: #64748b;
				--border-light: #e2e8f0;

				--radius-card: 20px;
				--radius-btn: 14px;
			}

			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
				-webkit-tap-highlight-color: transparent;
			}

			body {
				font-family: "DM Sans", sans-serif;
				background-color: var(--bg-body);
				display: flex;
				justify-content: center;
				min-height: 100vh;
			}

			.app-container {
				width: 100%;
				max-width: 414px;
				background-color: var(--bg-body);
				position: relative;
				padding-bottom: 120px; /* Space for drawer & nav */
				min-height: 100vh;
				overflow-x: hidden;
				box-shadow: 0 0 50px rgba(0, 0, 0, 0.05);
			}

			/* --- Header & Toggle --- */
			.header-section {
				background: var(--surface);
				padding: 24px 24px 20px 24px;
				border-bottom-left-radius: 30px;
				border-bottom-right-radius: 30px;
				box-shadow: 0 4px 20px rgba(0, 0, 0, 0.03);
				position: relative;
				z-index: 10;
			}

			.page-title {
				font-size: 22px;
				font-weight: 700;
				color: var(--text-main);
				margin-bottom: 20px;
				display: flex;
				justify-content: space-between;
				align-items: center;
			}

			/* Segmented Control Toggle */
			.toggle-container {
				background: #f1f5f9;
				border-radius: 16px;
				padding: 4px;
				display: flex;
				position: relative;
			}

			.toggle-btn {
				flex: 1;
				text-align: center;
				padding: 10px;
				font-size: 14px;
				font-weight: 600;
				color: var(--text-secondary);
				z-index: 2;
				cursor: pointer;
				transition: color 0.3s;
			}

			.toggle-btn.active {
				color: var(--primary);
			}

			/* The sliding background pill */
			.toggle-bg {
				position: absolute;
				top: 4px;
				bottom: 4px;
				left: 4px;
				width: calc(50% - 4px);
				background: white;
				border-radius: 12px;
				box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
				transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
				z-index: 1;
			}

			/* --- VIEWS --- */
			.view-section {
				padding: 24px;
				display: none; /* Hidden by default */
				animation: fadeIn 0.4s ease;
			}
			.view-section.active-view {
				display: block;
			}

			@keyframes fadeIn {
				from {
					opacity: 0;
					transform: translateY(10px);
				}
				to {
					opacity: 1;
					transform: translateY(0);
				}
			}

			/* === VIEW A: SMART PANTRY (COOK) === */

			/* Ingredient Input */
			.pantry-box {
				background: var(--surface);
				padding: 16px;
				border-radius: var(--radius-card);
				margin-bottom: 24px;
			}

			.sub-tabs {
				display: flex;
				gap: 8px;
				background: #f1f5f9;
				border-radius: 14px;
				padding: 4px;
				margin-bottom: 16px;
			}

			.sub-tab {
				flex: 1;
				text-align: center;
				padding: 8px;
				border-radius: 10px;
				font-size: 12px;
				font-weight: 700;
				color: var(--text-secondary);
				cursor: pointer;
			}

			.sub-tab.active {
				background: white;
				color: var(--text-main);
				box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
			}

			.leftover-card {
				background: var(--surface);
				border-radius: var(--radius-card);
				padding: 14px;
				display: flex;
				align-items: center;
				justify-content: space-between;
				gap: 12px;
				margin-bottom: 12px;
				box-shadow: 0 4px 10px rgba(0, 0, 0, 0.02);
			}

			.leftover-info h4 {
				font-size: 15px;
				font-weight: 700;
				color: var(--text-main);
				margin-bottom: 4px;
			}

			.leftover-info p {
				font-size: 12px;
				color: var(--text-secondary);
			}

			.leftover-actions {
				display: flex;
				gap: 6px;
			}

			.leftover-btn {
				border: none;
				padding: 6px 10px;
				border-radius: 10px;
				font-size: 11px;
				font-weight: 700;
				cursor: pointer;
				background: #eef2ff;
				color: var(--primary);
			}

			.leftover-btn.ghost {
				background: #f8fafc;
				color: var(--text-secondary);
			}

			.input-group {
				display: flex;
				gap: 10px;
				margin-bottom: 12px;
			}

			.pantry-input {
				flex: 1;
				background: #f8fafc;
				border: none;
				padding: 12px;
				border-radius: 12px;
				font-size: 14px;
				outline: none;
			}

			.add-btn {
				background: var(--primary);
				color: white;
				width: 44px;
				border-radius: 12px;
				border: none;
				font-size: 18px;
				cursor: pointer;
			}

			.tags-container {
				display: flex;
				flex-wrap: wrap;
				gap: 8px;
			}

			.tag {
				background: var(--primary-light);
				color: var(--primary);
				padding: 6px 12px;
				border-radius: 20px;
				font-size: 12px;
				font-weight: 600;
				display: flex;
				align-items: center;
				gap: 6px;
			}

			.tag i {
				cursor: pointer;
				opacity: 0.6;
			}

			/* Recipe Cards */
			.section-label {
				font-size: 14px;
				font-weight: 700;
				color: var(--text-secondary);
				margin-bottom: 12px;
				text-transform: uppercase;
				letter-spacing: 0.5px;
			}

			.recipe-card {
				background: var(--surface);
				border-radius: var(--radius-card);
				padding: 12px;
				display: flex;
				gap: 16px;
				margin-bottom: 16px;
				box-shadow: 0 4px 10px rgba(0, 0, 0, 0.02);
				position: relative;
			}

			.recipe-img {
				width: 90px;
				height: 90px;
				border-radius: 16px;
				object-fit: cover;
				background: #eee;
			}

			.recipe-info {
				flex: 1;
				display: flex;
				flex-direction: column;
				justify-content: center;
			}

			.recipe-title {
				font-size: 16px;
				font-weight: 700;
				color: var(--text-main);
				margin-bottom: 4px;
			}

			.recipe-meta {
				font-size: 12px;
				color: var(--text-secondary);
				display: flex;
				gap: 10px;
				margin-bottom: 8px;
			}

			.missing-badge {
				font-size: 11px;
				color: var(--accent-gold);
				background: rgba(245, 158, 11, 0.1);
				padding: 4px 8px;
				border-radius: 6px;
				display: inline-block;
				width: fit-content;
			}

			.shop-action {
				position: absolute;
				bottom: 12px;
				right: 12px;
				width: 32px;
				height: 32px;
				background: #f1f5f9;
				border-radius: 50%;
				display: flex;
				align-items: center;
				justify-content: center;
				color: var(--text-main);
				cursor: pointer;
				transition: 0.2s;
			}
			.shop-action:hover {
				background: var(--primary);
				color: white;
			}

			/* === VIEW B: EAT OUT (MENU COACH) === */

			.location-bar {
				display: flex;
				align-items: center;
				gap: 8px;
				background: rgba(16, 185, 129, 0.1);
				padding: 12px 16px;
				border-radius: 16px;
				color: var(--accent-green);
				font-size: 13px;
				font-weight: 600;
				margin-bottom: 20px;
			}

			.restaurant-search {
				position: relative;
				margin-bottom: 24px;
			}
			.restaurant-search input {
				width: 100%;
				padding: 14px 14px 14px 44px;
				border-radius: 16px;
				border: 1px solid var(--border-light);
				font-size: 14px;
				background: var(--surface);
			}
			.search-icon {
				position: absolute;
				left: 16px;
				top: 14px;
				color: var(--text-secondary);
			}

			.menu-card {
				background: var(--surface);
				border-radius: var(--radius-card);
				padding: 20px;
				margin-bottom: 16px;
				border: 1px solid transparent;
				position: relative;
				overflow: hidden;
			}

			.best-match {
				border: 1px solid var(--accent-green);
				box-shadow: 0 10px 30px rgba(16, 185, 129, 0.15);
			}

			.match-score {
				position: absolute;
				top: 0;
				right: 0;
				background: var(--accent-green);
				color: white;
				padding: 6px 12px;
				border-bottom-left-radius: 16px;
				font-size: 12px;
				font-weight: 700;
			}

			.menu-brand {
				display: flex;
				align-items: center;
				gap: 8px;
				margin-bottom: 12px;
			}
			.brand-logo {
				width: 24px;
				height: 24px;
				border-radius: 50%;
				background: #ccc;
			}
			.brand-name {
				font-size: 14px;
				color: var(--text-secondary);
				font-weight: 600;
			}

			.item-name {
				font-size: 18px;
				font-weight: 700;
				color: var(--text-main);
				margin-bottom: 6px;
			}
			.item-desc {
				font-size: 13px;
				color: var(--text-secondary);
				line-height: 1.4;
				margin-bottom: 12px;
			}

			.macros-pill {
				background: #f1f5f9;
				padding: 6px 12px;
				border-radius: 8px;
				font-size: 12px;
				font-weight: 600;
				color: var(--text-main);
				display: inline-block;
			}

			/* === DRAWER: SHOPPING LIST === */
			.shopping-drawer {
				position: fixed;
				bottom: 0;
				left: 0;
				right: 0;
				background: white;
				border-top-left-radius: 24px;
				border-top-right-radius: 24px;
				box-shadow: 0 -5px 30px rgba(0, 0, 0, 0.1);
				transform: translateY(
					calc(100% - 60px)
				); /* Shows only header */
				transition: transform 0.4s cubic-bezier(0.2, 0.8, 0.2, 1);
				z-index: 100;
				max-width: 414px;
				margin: 0 auto;
			}

			.shopping-drawer.expanded {
				transform: translateY(0);
			}

			.drawer-header {
				padding: 16px 24px;
				cursor: pointer;
				border-bottom: 1px solid #f1f5f9;
			}

			.drawer-handle {
				width: 40px;
				height: 4px;
				background: #e2e8f0;
				border-radius: 10px;
				margin: 0 auto 12px;
			}

			.drawer-title-row {
				display: flex;
				justify-content: space-between;
				align-items: center;
			}

			.drawer-title {
				font-weight: 700;
				font-size: 16px;
				display: flex;
				align-items: center;
				gap: 8px;
			}
			.badge-count {
				background: var(--primary);
				color: white;
				font-size: 11px;
				padding: 2px 6px;
				border-radius: 10px;
			}

			.drawer-content {
				padding: 20px 24px 40px; /* Extra padding for bottom */
				height: 300px;
				overflow-y: auto;
			}

			.shop-item {
				display: flex;
				align-items: center;
				gap: 12px;
				padding: 12px 0;
				border-bottom: 1px solid #f8fafc;
			}

			.checkbox {
				width: 20px;
				height: 20px;
				border: 2px solid #cbd5e1;
				border-radius: 6px;
				display: flex;
				align-items: center;
				justify-content: center;
				cursor: pointer;
				color: white;
			}

			.checkbox.checked {
				background: var(--primary);
				border-color: var(--primary);
			}
			.shop-text {
				font-size: 14px;
				color: var(--text-main);
				flex: 1;
			}
			.checked + .shop-text {
				text-decoration: line-through;
				color: #cbd5e1;
			}

			.export-btn {
				margin-top: 20px;
				width: 100%;
				padding: 12px;
				background: var(--text-main);
				color: white;
				border-radius: 12px;
				border: none;
				font-weight: 600;
				display: flex;
				justify-content: center;
				gap: 8px;
				cursor: pointer;
			}

			.export-options {
				display: grid;
				grid-template-columns: 1fr;
				gap: 10px;
				margin-top: 12px;
			}

			.export-link {
				width: 100%;
				border: 1px solid #e2e8f0;
				background: #f8fafc;
				color: var(--text-main);
				padding: 10px 12px;
				border-radius: 12px;
				font-size: 12px;
				font-weight: 700;
				display: flex;
				align-items: center;
				justify-content: space-between;
				cursor: pointer;
			}

			.export-link span {
				color: var(--text-secondary);
				font-weight: 600;
			}

			/* --- Floating Nav (Consistent with Dashboard) --- */
			.nav-floater {
				position: fixed;
				bottom: 30px;
				left: 50%;
				transform: translateX(-50%);
				background: rgba(255, 255, 255, 0.9);
				backdrop-filter: blur(16px);
				padding: 10px 24px;
				border-radius: 40px;
				box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
				display: flex;
				align-items: center;
				gap: 30px;
				z-index: 101; /* Above drawer */
				width: 85%;
				max-width: 360px;
				justify-content: space-between;
				border: 1px solid rgba(255, 255, 255, 0.5);
			}

			.nav-icon {
				font-size: 20px;
				color: var(--text-secondary);
				cursor: pointer;
			}
			.nav-icon.active {
				color: var(--text-main);
			}
			.nav-fab {
				width: 50px;
				height: 50px;
				background: var(--text-main);
				border-radius: 50%;
				display: flex;
				align-items: center;
				justify-content: center;
				color: white;
				font-size: 20px;
				margin-top: -20px;
				box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
				border: 4px solid var(--bg-body);
				text-decoration: none;
			}

			.nav-fab.active {
				background: var(--primary);
				box-shadow: 0 8px 20px rgba(37, 99, 235, 0.35);
			}

			.nav-link {
				text-decoration: none;
				display: flex;
				align-items: center;
				justify-content: center;
			}

			.recipe-link {
				margin-top: 6px;
				background: #f1f5f9;
				border: none;
				padding: 6px 10px;
				border-radius: 10px;
				font-size: 11px;
				font-weight: 600;
				color: var(--text-main);
				cursor: pointer;
				width: fit-content;
			}

			/* Modals */
			.modal {
				position: fixed;
				inset: 0;
				background: rgba(15, 23, 42, 0.4);
				display: flex;
				align-items: center;
				justify-content: center;
				padding: 24px;
				opacity: 0;
				pointer-events: none;
				transition: opacity 0.2s ease;
				z-index: 120;
			}

			.modal.active {
				opacity: 1;
				pointer-events: auto;
			}

			.modal-card {
				width: 100%;
				max-width: 360px;
				background: var(--surface);
				border-radius: 20px;
				padding: 20px;
				box-shadow: 0 20px 40px rgba(15, 23, 42, 0.2);
			}

			.modal-header {
				display: flex;
				align-items: center;
				justify-content: space-between;
				margin-bottom: 12px;
			}

			.modal-title {
				font-size: 16px;
				font-weight: 700;
			}

			.modal-close {
				border: none;
				background: #f1f5f9;
				width: 32px;
				height: 32px;
				border-radius: 10px;
				cursor: pointer;
			}

			.modal-actions {
				display: flex;
				gap: 10px;
				margin-top: 16px;
				flex-wrap: wrap;
			}

			.btn-primary {
				flex: 1;
				background: var(--primary-gradient);
				color: white;
				border: none;
				padding: 12px;
				border-radius: 12px;
				font-weight: 600;
				text-decoration: none;
				text-align: center;
			}

			.btn-secondary {
				flex: 1;
				background: #f1f5f9;
				color: var(--text-main);
				border: none;
				padding: 12px;
				border-radius: 12px;
				font-weight: 600;
				cursor: pointer;
			}

			/* Toast */
			.toast {
				position: fixed;
				bottom: 100px;
				left: 50%;
				transform: translateX(-50%);
				background: rgba(15, 23, 42, 0.9);
				color: white;
				padding: 10px 16px;
				border-radius: 12px;
				font-size: 12px;
				opacity: 0;
				pointer-events: none;
				transition: opacity 0.2s ease;
				z-index: 150;
			}

			.toast.show {
				opacity: 1;
			}
		</style>
	</head>
	<body>
		<div class="app-container">
			<!-- Header & Toggle -->
			<div class="header-section">
				<div class="page-title">
					Smart Planner
					<i
						class="fa-regular fa-calendar"
						style="font-size: 20px; color: var(--primary)"
					></i>
				</div>

				<div class="toggle-container">
					<div class="toggle-bg" id="togglePill"></div>
					<div class="toggle-btn active" onclick="switchView('cook')">
						Cook at Home
					</div>
					<div class="toggle-btn" onclick="switchView('out')">
						Eat Out
					</div>
				</div>
			</div>

			<!-- === VIEW: COOK AT HOME === -->
			<div id="view-cook" class="view-section active-view">
				<div class="sub-tabs">
					<div
						class="sub-tab active"
						onclick="switchCookTab('pantry')"
					>
						Pantry
					</div>
					<div class="sub-tab" onclick="switchCookTab('leftovers')">
						Leftovers
					</div>
				</div>

				<div id="pantryView">
					<!-- Pantry Input -->
					<div class="pantry-box">
						<div class="section-label">Smart Pantry</div>
						<div class="input-group">
							<input
								type="text"
								class="pantry-input"
								placeholder="Add ingredients (e.g. Avocado)..."
							/>
							<button class="add-btn">
								<i class="fa-solid fa-plus"></i>
							</button>
						</div>
						<div class="tags-container">
							<div class="tag">
								Chicken Breast <i class="fa-solid fa-xmark"></i>
							</div>
							<div class="tag">
								Spinach <i class="fa-solid fa-xmark"></i>
							</div>
							<div class="tag">
								Rice <i class="fa-solid fa-xmark"></i>
							</div>
						</div>
					</div>

					<!-- Generated Recipes -->
					<div class="section-label">Matched Recipes</div>

					<!-- Recipe 1 -->
					<div class="recipe-card">
						<img
							src="https://images.unsplash.com/photo-1604908176997-125f25cc6f3d-ixlib=rb-4.0.3&auto=format&fit=crop&w=150&q=80"
							class="recipe-img"
							alt="Chicken Bowl"
						/>
						<div class="recipe-info">
							<div class="recipe-title">Power Chicken Bowl</div>
							<div class="recipe-meta">
								<span
									><i class="fa-regular fa-clock"></i>
									20m</span
								>
								<span
									><i class="fa-solid fa-fire"></i> 520
									kcal</span
								>
							</div>
							<div class="missing-badge">Missing: Lemon</div>
							<button
								class="recipe-link"
								onclick="openRecipe('power')"
							>
								View Recipe
							</button>
						</div>
						<div class="shop-action" onclick="addToShop(this)">
							<i class="fa-solid fa-cart-plus"></i>
						</div>
					</div>

					<!-- Recipe 2 -->
					<div class="recipe-card">
						<img
							src="https://images.unsplash.com/photo-1546069901-ba9599a7e63c-ixlib=rb-4.0.3&auto=format&fit=crop&w=150&q=80"
							class="recipe-img"
							alt="Salad"
						/>
						<div class="recipe-info">
							<div class="recipe-title">Green Keto Salad</div>
							<div class="recipe-meta">
								<span
									><i class="fa-regular fa-clock"></i>
									10m</span
								>
								<span
									><i class="fa-solid fa-fire"></i> 340
									kcal</span
								>
							</div>
							<div
								class="missing-badge"
								style="
									background: #f1f5f9;
									color: var(--text-secondary);
								"
							>
								Pantry Ready
							</div>
							<button
								class="recipe-link"
								onclick="openRecipe('keto')"
							>
								View Recipe
							</button>
						</div>
						<div class="shop-action" onclick="addToShop(this)">
							<i class="fa-solid fa-check"></i>
						</div>
					</div>
				</div>

				<div id="leftoverView" style="display: none">
					<div class="section-label">Leftovers</div>
					<div id="leftoverList"></div>
				</div>
			</div>

			<!-- === VIEW: EAT OUT === -->
			<div id="view-out" class="view-section">
				<!-- Location -->
				<div class="location-bar">
					<i class="fa-solid fa-location-dot"></i> Near 5th Avenue,
					NYC
				</div>

				<!-- Search -->
				<div class="restaurant-search">
					<i class="fa-solid fa-magnifying-glass search-icon"></i>
					<input
						type="text"
						placeholder="Search menu (e.g. Starbucks)"
					/>
				</div>

				<div class="section-label">Menu Coach</div>

				<!-- Recommendation 1 (Best) -->
				<div class="menu-card best-match">
					<div class="match-score">98% Match</div>
					<div class="menu-brand">
						<div
							class="brand-logo"
							style="background: #00704a"
						></div>
						<!-- Starbucks Green -->
						<span class="brand-name">Starbucks</span>
					</div>
					<div class="item-name">
						Spinach, Feta & Cage-Free Egg Wrap
					</div>
					<div class="item-desc">
						High protein, moderate carbs. Fits perfectly into your
						remaining post-workout macros.
					</div>
					<div class="macros-pill">290 kcal - 19g Protein</div>
				</div>

				<!-- Recommendation 2 -->
				<div class="menu-card">
					<div
						class="match-score"
						style="background: #cbd5e1; color: var(--text-main)"
					>
						85% Match
					</div>
					<div class="menu-brand">
						<div
							class="brand-logo"
							style="background: #a52a2a"
						></div>
						<!-- Chipotle Red -->
						<span class="brand-name">Chipotle</span>
					</div>
					<div class="item-name">Lifestyle Bowl (Paleo)</div>
					<div class="item-desc">
						Good choice, but ask for light dressing to stay under
						your fat limit.
					</div>
					<div class="macros-pill">500 kcal - 42g Protein</div>
				</div>
			</div>

			<!-- === SHOPPING LIST DRAWER === -->
			<div class="shopping-drawer" id="shoppingDrawer">
				<div class="drawer-header" onclick="toggleDrawer()">
					<div class="drawer-handle"></div>
					<div class="drawer-title-row">
						<div class="drawer-title">
							Shopping List <span class="badge-count">3</span>
						</div>
						<i class="fa-solid fa-chevron-up" id="drawerIcon"></i>
					</div>
				</div>

				<div class="drawer-content">
					<!-- Item 1 -->
					<div class="shop-item">
						<div class="checkbox" onclick="toggleCheck(this)">
							<i class="fa-solid fa-check"></i>
						</div>
						<span class="shop-text">Lemons (2)</span>
					</div>
					<!-- Item 2 -->
					<div class="shop-item">
						<div
							class="checkbox checked"
							onclick="toggleCheck(this)"
						>
							<i class="fa-solid fa-check"></i>
						</div>
						<span class="shop-text">Greek Yogurt</span>
					</div>
					<!-- Item 3 -->
					<div class="shop-item">
						<div class="checkbox" onclick="toggleCheck(this)">
							<i class="fa-solid fa-check"></i>
						</div>
						<span class="shop-text">Almonds</span>
					</div>

					<button
						class="export-btn"
						onclick="openModal('exportModal')"
					>
						<i class="fa-solid fa-basket-shopping"></i> Order or
						Export
					</button>
				</div>
			</div>

			<!-- Floating Nav -->
			<div class="nav-floater">
				<a
					class="nav-link"
					href="Dashbaord.html"
					aria-label="Dashboard"
				>
					<i class="fa-solid fa-house nav-icon"></i>
				</a>
				<a class="nav-link" href="Planner.html" aria-label="Planner">
					<i class="fa-regular fa-calendar-days nav-icon active"></i>
				</a>
				<a class="nav-fab" href="Capture.html" aria-label="Capture"
					><i class="fa-solid fa-plus"></i
				></a>
				<a
					class="nav-link"
					href="Analytics.html"
					aria-label="Analytics"
				>
					<i class="fa-solid fa-chart-simple nav-icon"></i>
				</a>
				<a class="nav-link" href="Settings.html" aria-label="Settings">
					<i class="fa-regular fa-user nav-icon"></i>
				</a>
			</div>
		</div>

		<div class="modal" id="recipeModal">
			<div class="modal-card">
				<div class="modal-header">
					<div class="modal-title" id="recipeTitle">
						Recipe Detail
					</div>
					<button
						class="modal-close"
						onclick="closeModal('recipeModal')"
					>
						<i class="fa-solid fa-xmark"></i>
					</button>
				</div>
				<div
					style="
						font-size: 12px;
						color: var(--text-secondary);
						margin-bottom: 12px;
					"
					id="recipeMeta"
				>
					20 min - 520 kcal
				</div>
				<div
					style="
						font-size: 12px;
						color: var(--text-main);
						margin-bottom: 12px;
					"
				>
					<strong>Ingredients</strong>
					<div id="recipeIngredients">
						Chicken, spinach, rice, lemon
					</div>
				</div>
				<div
					style="
						font-size: 12px;
						color: var(--text-secondary);
						line-height: 1.4;
					"
					id="recipeSteps"
				>
					Season chicken, pan-sear until golden, steam rice, toss
					greens, finish with lemon.
				</div>
				<div class="modal-actions">
					<button class="btn-primary" onclick="openLeftoverPrompt()">
						Cooked This
					</button>
					<button class="btn-secondary" onclick="addMissingToList()">
						Add Missing to List
					</button>
					<button
						class="btn-secondary"
						onclick="closeModal('recipeModal')"
					>
						Close
					</button>
				</div>
			</div>
		</div>

		<div class="modal" id="leftoverModal">
			<div class="modal-card">
				<div class="modal-header">
					<div class="modal-title">Save Leftovers-</div>
					<button
						class="modal-close"
						onclick="closeModal('leftoverModal')"
					>
						<i class="fa-solid fa-xmark"></i>
					</button>
				</div>
				<div
					style="
						font-size: 12px;
						color: var(--text-secondary);
						margin-bottom: 12px;
					"
					id="leftoverPrompt"
				>
					Did you cook the whole batch- We can add leftovers to your
					pantry.
				</div>
				<div class="modal-actions">
					<button class="btn-primary" onclick="confirmLeftovers()">
						Yes, add leftovers
					</button>
					<button
						class="btn-secondary"
						onclick="closeModal('leftoverModal')"
					>
						No, just this meal
					</button>
				</div>
			</div>
		</div>

		<div class="modal" id="exportModal">
			<div class="modal-card">
				<div class="modal-header">
					<div class="modal-title">Export Shopping List</div>
					<button
						class="modal-close"
						onclick="closeModal('exportModal')"
					>
						<i class="fa-solid fa-xmark"></i>
					</button>
				</div>
				<div style="font-size: 12px; color: var(--text-secondary)">
					Choose a service to order or export your list.
				</div>
				<div class="export-options">
					<button
						class="export-link"
						onclick="mockExport('Amazon Fresh')"
					>
						Amazon Fresh <span>Order</span>
					</button>
					<button
						class="export-link"
						onclick="mockExport('Instacart')"
					>
						Instacart <span>Order</span>
					</button>
					<button
						class="export-link"
						onclick="mockExport('Walmart Grocery')"
					>
						Walmart Grocery <span>Order</span>
					</button>
					<button class="export-link" onclick="mockExport('Kroger')">
						Kroger <span>Order</span>
					</button>
					<button class="export-link" onclick="copyList()">
						Copy List <span>Clipboard</span>
					</button>
				</div>
				<div class="modal-actions">
					<button
						class="btn-secondary"
						onclick="closeModal('exportModal')"
					>
						Close
					</button>
				</div>
			</div>
		</div>

		<div class="toast" id="toast">Saved</div>

		<script>
			const recipes = {
				power: {
					title: "Power Chicken Bowl",
					meta: "20 min - 520 kcal",
					ingredients:
						"Chicken breast, spinach, rice, lemon, olive oil",
					steps: "Sear chicken, steam rice, saute spinach, finish with lemon and olive oil.",
					batchServings: 4,
				},
				keto: {
					title: "Green Keto Salad",
					meta: "10 min - 340 kcal",
					ingredients:
						"Kale, avocado, cucumber, olive oil, pumpkin seeds",
					steps: "Chop greens, toss with avocado and cucumber, dress with olive oil, top seeds.",
					batchServings: 2,
				},
			};

			let toastTimer;
			let shoppingCount = 3;
			let cookTab = "pantry";
			let activeRecipeKey = null;
			let leftovers = [
				{
					id: "leftover-1",
					title: "Power Chicken Bowl",
					servings: 3,
					note: "Cooked today",
				},
				{
					id: "leftover-2",
					title: "Green Keto Salad",
					servings: 1,
					note: "Cooked yesterday",
				},
			];

			function switchView(view) {
				// Toggle Buttons
				const btns = document.querySelectorAll(".toggle-btn");
				const pill = document.getElementById("togglePill");

				btns.forEach((btn) => btn.classList.remove("active"));

				// Toggle Views
				document
					.getElementById("view-cook")
					.classList.remove("active-view");
				document
					.getElementById("view-out")
					.classList.remove("active-view");

				if (view === "cook") {
					btns[0].classList.add("active");
					pill.style.transform = "translateX(0)";
					document
						.getElementById("view-cook")
						.classList.add("active-view");
					switchCookTab(cookTab);
				} else {
					btns[1].classList.add("active");
					pill.style.transform = "translateX(100%)"; // Move pill right
					document
						.getElementById("view-out")
						.classList.add("active-view");
				}
			}

			function toggleDrawer() {
				const drawer = document.getElementById("shoppingDrawer");
				const icon = document.getElementById("drawerIcon");

				drawer.classList.toggle("expanded");

				if (drawer.classList.contains("expanded")) {
					icon.classList.remove("fa-chevron-up");
					icon.classList.add("fa-chevron-down");
				} else {
					icon.classList.remove("fa-chevron-down");
					icon.classList.add("fa-chevron-up");
				}
			}

			function toggleCheck(el) {
				el.classList.toggle("checked");
			}

			function addToShop(btn) {
				// Simple visual feedback
				const original = btn.innerHTML;
				btn.innerHTML = '<i class="fa-solid fa-check"></i>';
				btn.style.background = "#10B981";
				btn.style.color = "white";

				setTimeout(() => {
					// Animate Drawer Hint
					const drawer = document.getElementById("shoppingDrawer");
					drawer.style.transform = "translateY(calc(100% - 70px))"; // Bounce up
					setTimeout(() => {
						if (!drawer.classList.contains("expanded")) {
							drawer.style.transform =
								"translateY(calc(100% - 60px))";
						}
					}, 300);
				}, 300);
			}

			function openRecipe(key) {
				const data = recipes[key];
				if (!data) {
					return;
				}
				activeRecipeKey = key;
				document.getElementById("recipeTitle").textContent = data.title;
				document.getElementById("recipeMeta").textContent = data.meta;
				document.getElementById("recipeIngredients").textContent =
					data.ingredients;
				document.getElementById("recipeSteps").textContent = data.steps;
				openModal("recipeModal");
			}

			function openLeftoverPrompt() {
				if (!activeRecipeKey || !recipes[activeRecipeKey]) {
					showToast("Select a recipe first");
					return;
				}
				const recipe = recipes[activeRecipeKey];
				const prompt = document.getElementById("leftoverPrompt");
				if (prompt) {
					prompt.textContent =
						"Did you cook the whole batch of " +
						recipe.title +
						"- We can add leftovers to your pantry.";
				}
				openModal("leftoverModal");
			}

			function confirmLeftovers() {
				if (!activeRecipeKey || !recipes[activeRecipeKey]) {
					closeModal("leftoverModal");
					return;
				}
				const recipe = recipes[activeRecipeKey];
				const batch = recipe.batchServings || 2;
				const servingsLeft = Math.max(batch - 1, 1);
				leftovers.unshift({
					id: "leftover-" + Date.now(),
					title: recipe.title,
					servings: servingsLeft,
					note: "Cooked today",
				});
				renderLeftovers();
				closeModal("leftoverModal");
				closeModal("recipeModal");
				showToast("Leftovers added");
				switchCookTab("leftovers");
			}

			function logLeftover(id) {
				const item = leftovers.find((entry) => entry.id === id);
				if (!item) {
					return;
				}
				item.servings -= 1;
				if (item.servings <= 0) {
					leftovers = leftovers.filter((entry) => entry.id !== id);
				}
				renderLeftovers();
				showToast("Leftover logged");
			}

			function removeLeftover(id) {
				leftovers = leftovers.filter((entry) => entry.id !== id);
				renderLeftovers();
				showToast("Leftover removed");
			}

			function addMissingToList() {
				shoppingCount += 1;
				const badge = document.querySelector(".badge-count");
				if (badge) {
					badge.textContent = shoppingCount;
				}
				showToast("Added missing items");
				closeModal("recipeModal");
			}

			function mockExport(service) {
				showToast(service + " order queued");
				closeModal("exportModal");
			}

			function copyList() {
				const items = Array.from(
					document.querySelectorAll(".shop-text"),
				)
					.map((el) => el.textContent.trim())
					.filter(Boolean);
				const text = items.join(", ");
				if (navigator.clipboard && navigator.clipboard.writeText) {
					navigator.clipboard.writeText(text).catch(() => {});
				}
				showToast("Shopping list copied");
				closeModal("exportModal");
			}

			function showToast(message) {
				const toast = document.getElementById("toast");
				toast.textContent = message;
				toast.classList.add("show");
				clearTimeout(toastTimer);
				toastTimer = setTimeout(
					() => toast.classList.remove("show"),
					1600,
				);
			}

			function openModal(id) {
				const modal = document.getElementById(id);
				if (modal) {
					modal.classList.add("active");
				}
			}

			function switchCookTab(tab) {
				cookTab = tab;
				document.querySelectorAll(".sub-tab").forEach((btn) => {
					btn.classList.toggle(
						"active",
						btn.textContent.trim().toLowerCase() === tab,
					);
				});
				const pantry = document.getElementById("pantryView");
				const leftover = document.getElementById("leftoverView");
				if (pantry && leftover) {
					pantry.style.display = tab === "pantry" ? "block" : "none";
					leftover.style.display =
						tab === "leftovers" ? "block" : "none";
				}
				if (tab === "leftovers") {
					renderLeftovers();
				}
			}

			function renderLeftovers() {
				const list = document.getElementById("leftoverList");
				if (!list) {
					return;
				}
				list.innerHTML = "";
				if (!leftovers.length) {
					list.innerHTML =
						'<div style="font-size:12px; color:var(--text-secondary);">No leftovers yet. Cook a batch to save servings here.</div>';
					return;
				}
				leftovers.forEach((item) => {
					const card = document.createElement("div");
					card.className = "leftover-card";
					const info = document.createElement("div");
					info.className = "leftover-info";
					info.innerHTML =
						"<h4>" +
						item.title +
						"</h4><p>" +
						item.servings +
						" servings - " +
						item.note +
						"</p>";
					const actions = document.createElement("div");
					actions.className = "leftover-actions";
					const logBtn = document.createElement("button");
					logBtn.className = "leftover-btn";
					logBtn.textContent = "Log";
					logBtn.addEventListener("click", () =>
						logLeftover(item.id),
					);
					const removeBtn = document.createElement("button");
					removeBtn.className = "leftover-btn ghost";
					removeBtn.textContent = "Remove";
					removeBtn.addEventListener("click", () =>
						removeLeftover(item.id),
					);
					actions.appendChild(logBtn);
					actions.appendChild(removeBtn);
					card.appendChild(info);
					card.appendChild(actions);
					list.appendChild(card);
				});
			}

			function closeModal(id) {
				const modal = document.getElementById(id);
				if (modal) {
					modal.classList.remove("active");
				}
			}

			renderLeftovers();
			switchCookTab("pantry");
		</script>
	</body>
</html>
