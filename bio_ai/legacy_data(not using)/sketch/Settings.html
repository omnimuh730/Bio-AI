<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Bio AI - Settings</title>
		<link
			href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&family=Inter:wght@400;500;600&display=swap"
			rel="stylesheet"
		/>
		<link
			rel="stylesheet"
			href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
		/>

		<style>
			:root {
				/* Brand Colors */
				--primary: #4b7bff;
				--primary-gradient: linear-gradient(
					135deg,
					#4b7bff 0%,
					#2563eb 100%
				);
				--accent-green: #10b981;
				--accent-red: #ef4444;
				--accent-gold: #f59e0b;

				--bg-body: #f2f5f9;
				--surface: #ffffff;
				--text-main: #1e293b;
				--text-secondary: #64748b;

				--radius-card: 20px;
				--radius-btn: 12px;
			}

			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
				-webkit-tap-highlight-color: transparent;
			}

			body {
				font-family: "DM Sans", sans-serif;
				background-color: var(--bg-body);
				display: flex;
				justify-content: center;
				min-height: 100vh;
			}

			.app-container {
				width: 100%;
				max-width: 414px;
				background-color: var(--bg-body);
				position: relative;
				padding-bottom: 120px;
				min-height: 100vh;
				overflow-x: hidden;
			}

			/* --- Header Profile --- */
			.profile-header {
				background: var(--surface);
				padding: 40px 24px 30px;
				text-align: center;
				border-bottom-left-radius: 30px;
				border-bottom-right-radius: 30px;
				box-shadow: 0 4px 20px rgba(0, 0, 0, 0.03);
				margin-bottom: 24px;
			}

			.avatar-container {
				position: relative;
				width: 80px;
				height: 80px;
				margin: 0 auto 12px;
			}

			.avatar-img {
				width: 100%;
				height: 100%;
				border-radius: 50%;
				object-fit: cover;
				border: 3px solid white;
				box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
			}

			.pro-badge {
				position: absolute;
				bottom: 0;
				right: 0;
				background: var(--accent-gold);
				color: white;
				font-size: 10px;
				font-weight: 700;
				padding: 4px 8px;
				border-radius: 10px;
				border: 2px solid white;
			}

			.pro-badge.free {
				background: #cbd5e1;
			}

			.user-name {
				font-size: 20px;
				font-weight: 700;
				color: var(--text-main);
				margin-bottom: 4px;
			}
			.user-email {
				font-size: 13px;
				color: var(--text-secondary);
			}

			/* --- Common Section Styles --- */
			.settings-section {
				padding: 0 24px;
				margin-bottom: 24px;
			}

			.section-label {
				font-size: 14px;
				font-weight: 700;
				color: var(--text-secondary);
				margin-bottom: 12px;
				text-transform: uppercase;
				letter-spacing: 0.5px;
			}

			.settings-card {
				background: var(--surface);
				border-radius: var(--radius-card);
				overflow: hidden;
				box-shadow: 0 2px 8px rgba(0, 0, 0, 0.02);
			}

			/* Unit Toggle */
			.unit-toggle {
				margin: 20px;
				display: flex;
				background: #f1f5f9;
				border-radius: 14px;
				padding: 4px;
			}

			.unit-btn {
				flex: 1;
				text-align: center;
				padding: 10px;
				border-radius: 12px;
				font-size: 13px;
				font-weight: 600;
				color: var(--text-secondary);
				cursor: pointer;
			}

			.unit-btn.active {
				background: white;
				color: var(--text-main);
				box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
			}

			.unit-preview {
				padding: 0 20px 20px;
				display: grid;
				grid-template-columns: repeat(2, 1fr);
				gap: 12px;
			}

			.unit-item {
				background: #f8fafc;
				border-radius: 12px;
				padding: 10px 12px;
				font-size: 11px;
				color: var(--text-secondary);
			}

			.unit-item strong {
				display: block;
				font-size: 14px;
				color: var(--text-main);
				margin-top: 4px;
			}

			.setting-row {
				display: flex;
				align-items: center;
				justify-content: space-between;
				padding: 16px 20px;
				border-bottom: 1px solid #f1f5f9;
			}

			.setting-row:last-child {
				border-bottom: none;
			}

			.setting-info {
				display: flex;
				flex-direction: column;
				gap: 4px;
			}

			.setting-info h4 {
				font-size: 14px;
				font-weight: 600;
				color: var(--text-main);
			}
			.setting-info p {
				font-size: 11px;
				color: var(--text-secondary);
			}

			/* --- A. Device Integration --- */
			.device-row {
				display: flex;
				align-items: center;
				justify-content: space-between;
				padding: 16px 20px;
				border-bottom: 1px solid #f1f5f9;
			}
			.device-row:last-child {
				border-bottom: none;
			}

			.device-info {
				display: flex;
				align-items: center;
				gap: 12px;
			}
			.device-icon {
				width: 36px;
				height: 36px;
				background: #f8fafc;
				border-radius: 10px;
				display: flex;
				align-items: center;
				justify-content: center;
				font-size: 18px;
				color: var(--text-main);
			}

			.device-text h4 {
				font-size: 15px;
				font-weight: 600;
				color: var(--text-main);
			}
			.device-text p {
				font-size: 11px;
				color: var(--text-secondary);
			}
			.synced-text {
				color: var(--accent-green);
			}
			.device-status.syncing {
				color: var(--primary);
			}

			/* iOS Toggle Switch */
			.toggle-switch {
				position: relative;
				width: 44px;
				height: 24px;
				background: #e2e8f0;
				border-radius: 20px;
				cursor: pointer;
				transition: 0.3s;
			}
			.toggle-switch::after {
				content: "";
				position: absolute;
				top: 2px;
				left: 2px;
				width: 20px;
				height: 20px;
				background: white;
				border-radius: 50%;
				transition: 0.3s;
				box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
			}
			.toggle-switch.active {
				background: var(--accent-green);
			}
			.toggle-switch.active::after {
				transform: translateX(20px);
			}

			.sync-btn {
				width: 100%;
				padding: 12px;
				background: #f0fdf4;
				color: var(--accent-green);
				font-weight: 600;
				font-size: 13px;
				border: none;
				cursor: pointer;
				display: flex;
				align-items: center;
				justify-content: center;
				gap: 6px;
			}

			.reauth-btn {
				width: 100%;
				padding: 12px;
				background: #eef2ff;
				color: var(--primary);
				font-weight: 600;
				font-size: 13px;
				border: none;
				cursor: pointer;
				display: flex;
				align-items: center;
				justify-content: center;
				gap: 6px;
			}

			.find-btn {
				width: 100%;
				padding: 12px;
				background: #f8fafc;
				color: var(--text-main);
				font-weight: 600;
				font-size: 13px;
				border: none;
				cursor: pointer;
				display: flex;
				align-items: center;
				justify-content: center;
				gap: 6px;
			}

			/* --- B. Dietary Profile --- */
			.chips-container {
				padding: 20px;
				display: flex;
				flex-wrap: wrap;
				gap: 10px;
			}

			.chip {
				padding: 8px 16px;
				background: #f1f5f9;
				border-radius: 20px;
				font-size: 13px;
				font-weight: 600;
				color: var(--text-secondary);
				cursor: pointer;
				border: 1px solid transparent;
				transition: 0.2s;
			}

			.chip.active {
				background: rgba(75, 123, 255, 0.1);
				color: var(--primary);
				border-color: var(--primary);
			}

			.input-row {
				padding: 0 20px 20px;
			}
			.text-input {
				width: 100%;
				padding: 12px;
				background: #f8fafc;
				border: 1px solid #e2e8f0;
				border-radius: 12px;
				font-size: 14px;
				outline: none;
				color: var(--text-main);
			}

			/* --- C. Biological Profile --- */
			.bio-label {
				font-size: 11px;
				color: var(--text-secondary);
				font-weight: 600;
				margin-bottom: 4px;
				display: block;
			}
			.bio-val {
				font-size: 15px;
				font-weight: 600;
				color: var(--text-main);
				width: 100%;
				border: none;
				outline: none;
			}

			.goal-selector {
				padding: 20px;
			}
			.goal-option {
				display: flex;
				align-items: center;
				justify-content: space-between;
				padding: 12px;
				border-radius: 12px;
				border: 1px solid #e2e8f0;
				margin-bottom: 8px;
				cursor: pointer;
			}
			.goal-option.selected {
				border-color: var(--primary);
				background: rgba(75, 123, 255, 0.05);
			}
			.goal-check {
				width: 18px;
				height: 18px;
				border-radius: 50%;
				border: 2px solid #cbd5e1;
				display: flex;
				align-items: center;
				justify-content: center;
			}
			.selected .goal-check {
				border-color: var(--primary);
			}
			.selected .goal-check::after {
				content: "";
				width: 10px;
				height: 10px;
				background: var(--primary);
				border-radius: 50%;
			}

			/* --- D. Account Actions --- */
			.action-row {
				display: flex;
				align-items: center;
				gap: 12px;
				padding: 16px 20px;
				border-bottom: 1px solid #f1f5f9;
				cursor: pointer;
			}
			.action-row:last-child {
				border-bottom: none;
			}
			.action-icon {
				width: 30px;
				display: flex;
				justify-content: center;
				color: var(--text-secondary);
			}
			.action-label {
				flex: 1;
				font-size: 14px;
				font-weight: 600;
				color: var(--text-main);
			}

			.danger-text {
				color: var(--accent-red);
			}
			.gold-text {
				color: var(--accent-gold);
			}

			/* --- Floating Nav --- */
			.nav-floater {
				position: fixed;
				bottom: 30px;
				left: 50%;
				transform: translateX(-50%);
				background: rgba(255, 255, 255, 0.9);
				backdrop-filter: blur(16px);
				padding: 10px 24px;
				border-radius: 40px;
				box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
				display: flex;
				align-items: center;
				gap: 30px;
				z-index: 100;
				width: 85%;
				max-width: 360px;
				justify-content: space-between;
				border: 1px solid rgba(255, 255, 255, 0.5);
			}
			.nav-icon {
				font-size: 20px;
				color: var(--text-secondary);
				cursor: pointer;
			}
			.nav-icon.active {
				color: var(--text-main);
			}
			.nav-fab {
				width: 50px;
				height: 50px;
				background: var(--text-main);
				border-radius: 50%;
				display: flex;
				align-items: center;
				justify-content: center;
				color: white;
				font-size: 20px;
				margin-top: -20px;
				box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
				border: 4px solid var(--bg-body);
				text-decoration: none;
			}

			.nav-fab.active {
				background: var(--primary);
				box-shadow: 0 8px 20px rgba(37, 99, 235, 0.35);
			}

			.nav-link {
				text-decoration: none;
				display: flex;
				align-items: center;
				justify-content: center;
			}

			/* Modals */
			.modal {
				position: fixed;
				inset: 0;
				background: rgba(15, 23, 42, 0.4);
				display: flex;
				align-items: center;
				justify-content: center;
				padding: 24px;
				opacity: 0;
				pointer-events: none;
				transition: opacity 0.2s ease;
				z-index: 120;
			}

			.modal.active {
				opacity: 1;
				pointer-events: auto;
			}

			.modal-card {
				width: 100%;
				max-width: 360px;
				background: var(--surface);
				border-radius: 20px;
				padding: 20px;
				box-shadow: 0 20px 40px rgba(15, 23, 42, 0.2);
			}

			.modal-header {
				display: flex;
				align-items: center;
				justify-content: space-between;
				margin-bottom: 12px;
			}

			.modal-title {
				font-size: 16px;
				font-weight: 700;
			}

			.modal-close {
				border: none;
				background: #f1f5f9;
				width: 32px;
				height: 32px;
				border-radius: 10px;
				cursor: pointer;
			}

			.modal-actions {
				display: flex;
				gap: 10px;
				margin-top: 16px;
			}

			.btn-primary {
				flex: 1;
				background: var(--primary-gradient);
				color: white;
				border: none;
				padding: 12px;
				border-radius: 12px;
				font-weight: 600;
				text-decoration: none;
				text-align: center;
			}

			.btn-secondary {
				flex: 1;
				background: #f1f5f9;
				color: var(--text-main);
				border: none;
				padding: 12px;
				border-radius: 12px;
				font-weight: 600;
				cursor: pointer;
			}

			.btn-danger {
				flex: 1;
				background: var(--accent-red);
				color: white;
				border: none;
				padding: 12px;
				border-radius: 12px;
				font-weight: 600;
				cursor: pointer;
			}

			.btn-danger:disabled {
				opacity: 0.5;
				cursor: not-allowed;
			}

			.plan-options {
				display: grid;
				grid-template-columns: 1fr;
				gap: 10px;
				margin-top: 12px;
			}

			.plan-card {
				border: 1px solid #e2e8f0;
				border-radius: 14px;
				padding: 12px;
				font-size: 13px;
				font-weight: 600;
				display: flex;
				justify-content: space-between;
				align-items: center;
				cursor: pointer;
			}

			.plan-card.active {
				border-color: var(--primary);
				background: rgba(75, 123, 255, 0.08);
				color: var(--primary);
			}

			.device-modal-list {
				display: flex;
				flex-direction: column;
				gap: 10px;
				font-size: 12px;
				color: var(--text-secondary);
			}

			.device-modal-row {
				display: flex;
				align-items: center;
				justify-content: space-between;
				background: #f8fafc;
				padding: 10px 12px;
				border-radius: 12px;
			}

			.device-modal-row strong {
				color: var(--text-main);
				font-size: 13px;
			}

			.device-action {
				border: none;
				background: white;
				border-radius: 10px;
				padding: 6px 10px;
				font-size: 11px;
				font-weight: 700;
				cursor: pointer;
				color: var(--primary);
			}

			.device-action.connected {
				color: var(--accent-green);
			}

			.scan-pill {
				display: inline-flex;
				align-items: center;
				gap: 6px;
				background: #eef2ff;
				color: var(--primary);
				font-size: 11px;
				font-weight: 600;
				border-radius: 12px;
				padding: 4px 8px;
			}

			.scan-dot {
				width: 6px;
				height: 6px;
				border-radius: 50%;
				background: var(--primary);
				box-shadow: 0 0 6px rgba(75, 123, 255, 0.6);
				animation: pulse 1.6s infinite;
			}

			@keyframes pulse {
				0% {
					transform: scale(0.8);
					opacity: 0.6;
				}
				50% {
					transform: scale(1);
					opacity: 1;
				}
				100% {
					transform: scale(0.8);
					opacity: 0.6;
				}
			}

			/* Toast */
			.toast {
				position: fixed;
				bottom: 100px;
				left: 50%;
				transform: translateX(-50%);
				background: rgba(15, 23, 42, 0.9);
				color: white;
				padding: 10px 16px;
				border-radius: 12px;
				font-size: 12px;
				opacity: 0;
				pointer-events: none;
				transition: opacity 0.2s ease;
				z-index: 200;
			}

			.toast.show {
				opacity: 1;
			}
		</style>
	</head>
	<body>
		<div class="app-container">
			<!-- Profile Header -->
			<div class="profile-header">
				<div class="avatar-container">
					<img
						src="https://images.unsplash.com/photo-1534528741775-53994a69daeb?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&q=80"
						class="avatar-img"
						alt="Profile"
					/>
					<div class="pro-badge">PRO</div>
				</div>
				<div class="user-name">Dekomori Sanae</div>
				<div class="user-email">sanae@Bio AI.ai</div>
			</div>

			<!-- A. Device Integration -->
			<div class="settings-section">
				<div class="section-label">Device Sync</div>
				<div class="settings-card">
					<!-- Apple Health -->
					<div class="device-row" data-device="apple">
						<div class="device-info">
							<div class="device-icon">
								<i class="fa-brands fa-apple"></i>
							</div>
							<div class="device-text">
								<h4>Apple Health</h4>
								<p class="device-status synced-text">
									Synced: 2m ago
								</p>
							</div>
						</div>
						<div
							class="toggle-switch active"
							onclick="toggleDevice('apple')"
						></div>
					</div>

					<!-- Google Fit -->
					<div class="device-row" data-device="google">
						<div class="device-info">
							<div class="device-icon">
								<i class="fa-brands fa-google"></i>
							</div>
							<div class="device-text">
								<h4>Google Fit</h4>
								<p class="device-status">Disconnected</p>
							</div>
						</div>
						<div
							class="toggle-switch"
							onclick="toggleDevice('google')"
						></div>
					</div>

					<!-- Garmin -->
					<div class="device-row" data-device="garmin">
						<div class="device-info">
							<div class="device-icon">
								<i class="fa-solid fa-watch"></i>
							</div>
							<div class="device-text">
								<h4>Garmin</h4>
								<p class="device-status">Disconnected</p>
							</div>
						</div>
						<div
							class="toggle-switch"
							onclick="toggleDevice('garmin')"
						></div>
					</div>

					<!-- Fitbit -->
					<div class="device-row" data-device="fitbit">
						<div class="device-info">
							<div class="device-icon">
								<i class="fa-solid fa-heart-pulse"></i>
							</div>
							<div class="device-text">
								<h4>Fitbit</h4>
								<p class="device-status synced-text">
									Synced: 12m ago
								</p>
							</div>
						</div>
						<div
							class="toggle-switch active"
							onclick="toggleDevice('fitbit')"
						></div>
					</div>

					<button class="sync-btn" onclick="forceResync()">
						<i class="fa-solid fa-rotate"></i> Force Re-Sync
					</button>
					<button class="reauth-btn" onclick="openReauthModal()">
						<i class="fa-solid fa-key"></i> Re-Auth Devices
					</button>
					<button class="find-btn" onclick="openFindModal()">
						<i class="fa-solid fa-magnifying-glass"></i> Find
						Devices
					</button>
				</div>
			</div>

			<!-- B. Dietary Profile -->
			<div class="settings-section">
				<div class="section-label">Dietary Rules</div>
				<div class="settings-card">
					<div class="chips-container">
						<div class="chip active" onclick="toggleChip(this)">
							Keto
						</div>
						<div class="chip" onclick="toggleChip(this)">Vegan</div>
						<div class="chip" onclick="toggleChip(this)">Paleo</div>
						<div class="chip active" onclick="toggleChip(this)">
							Gluten Free
						</div>
						<div class="chip" onclick="toggleChip(this)">
							Pescatarian
						</div>
					</div>

					<div class="input-row">
						<label class="bio-label" style="margin-bottom: 8px"
							>Allergies / Dislikes</label
						>
						<input
							type="text"
							class="text-input"
							value="Peanuts, Mushrooms"
						/>
					</div>
				</div>
			</div>

			<!-- Units & Alerts -->
			<div class="settings-section">
				<div class="section-label">Units & Alerts</div>
				<div class="settings-card">
					<div class="unit-toggle">
						<div class="unit-btn active" onclick="setUnits(this)">
							Metric
						</div>
						<div class="unit-btn" onclick="setUnits(this)">
							Imperial
						</div>
					</div>
					<div class="unit-preview">
						<div class="unit-item">
							Weight
							<strong id="weightVal">72 kg</strong>
						</div>
						<div class="unit-item">
							Height
							<strong id="heightVal">172 cm</strong>
						</div>
						<div class="unit-item">
							Water Goal
							<strong id="waterVal">2,500 ml</strong>
						</div>
						<div class="unit-item">
							Daily Burn
							<strong id="burnVal">620 kcal</strong>
						</div>
					</div>

					<div class="setting-row">
						<div class="setting-info">
							<h4>Smart Reminders</h4>
							<p>Meal time, hydration, and protein nudges.</p>
						</div>
						<div
							class="toggle-switch active"
							onclick="toggleSwitch(this)"
						></div>
					</div>

					<div class="setting-row">
						<div class="setting-info">
							<h4>Bio Alerts</h4>
							<p>Notify when stress or sleep drops.</p>
						</div>
						<div
							class="toggle-switch active"
							onclick="toggleSwitch(this)"
						></div>
					</div>

					<div class="setting-row">
						<div class="setting-info">
							<h4>Offline Mode</h4>
							<p>Queue uploads and cache today plan.</p>
						</div>
						<div
							class="toggle-switch"
							onclick="toggleSwitch(this)"
						></div>
					</div>
				</div>
			</div>

			<!-- C. Biological Profile -->
			<div class="settings-section">
				<div class="section-label">Goal Setting</div>
				<div class="settings-card">
					<div class="goal-selector">
						<div
							class="goal-option selected"
							onclick="selectGoal(this)"
						>
							<span style="font-size: 14px; font-weight: 600"
								>Lose Fat</span
							>
							<div class="goal-check"></div>
						</div>
						<div class="goal-option" onclick="selectGoal(this)">
							<span style="font-size: 14px; font-weight: 600"
								>Build Muscle</span
							>
							<div class="goal-check"></div>
						</div>
						<div class="goal-option" onclick="selectGoal(this)">
							<span style="font-size: 14px; font-weight: 600"
								>Maintain & Cognitive</span
							>
							<div class="goal-check"></div>
						</div>
					</div>
				</div>
			</div>

			<!-- D. Account & Data -->
			<div class="settings-section">
				<div class="section-label">Account</div>
				<div class="settings-card">
					<div
						class="action-row"
						onclick="window.location.href = 'Onboarding.html'"
					>
						<div class="action-icon">
							<i class="fa-solid fa-list-check"></i>
						</div>
						<div class="action-label">Revisit Onboarding</div>
						<i
							class="fa-solid fa-chevron-right"
							style="font-size: 12px; color: #cbd5e1"
						></i>
					</div>

					<div
						class="action-row"
						onclick="openModal('subscriptionModal')"
					>
						<div class="action-icon gold-text">
							<i class="fa-solid fa-crown"></i>
						</div>
						<div class="action-label gold-text">
							Manage Subscription
						</div>
						<i
							class="fa-solid fa-chevron-right"
							style="font-size: 12px; color: #cbd5e1"
						></i>
					</div>

					<div class="action-row" onclick="openModal('exportModal')">
						<div class="action-icon">
							<i class="fa-solid fa-file-export"></i>
						</div>
						<div class="action-label">Export Data</div>
						<i
							class="fa-solid fa-chevron-right"
							style="font-size: 12px; color: #cbd5e1"
						></i>
					</div>

					<div class="action-row" onclick="openModal('deleteModal')">
						<div class="action-icon danger-text">
							<i class="fa-solid fa-trash"></i>
						</div>
						<div class="action-label danger-text">
							Delete Account
						</div>
					</div>
				</div>
			</div>

			<!-- Floating Nav -->
			<div class="nav-floater">
				<a
					class="nav-link"
					href="Dashbaord.html"
					aria-label="Dashboard"
				>
					<i class="fa-solid fa-house nav-icon"></i>
				</a>
				<a class="nav-link" href="Planner.html" aria-label="Planner">
					<i class="fa-regular fa-calendar-days nav-icon"></i>
				</a>
				<a class="nav-fab" href="Capture.html" aria-label="Capture"
					><i class="fa-solid fa-plus"></i
				></a>
				<a
					class="nav-link"
					href="Analytics.html"
					aria-label="Analytics"
				>
					<i class="fa-solid fa-chart-simple nav-icon"></i>
				</a>
				<a class="nav-link" href="Settings.html" aria-label="Settings">
					<i class="fa-regular fa-user nav-icon active"></i>
				</a>
			</div>
		</div>

		<div class="modal" id="subscriptionModal">
			<div class="modal-card">
				<div class="modal-header">
					<div class="modal-title">Subscription</div>
					<button
						class="modal-close"
						onclick="closeModal('subscriptionModal')"
					>
						<i class="fa-solid fa-xmark"></i>
					</button>
				</div>
				<div style="font-size: 12px; color: var(--text-secondary)">
					Current plan: <strong id="currentPlan">Pro Monthly</strong>
				</div>
				<div class="plan-options">
					<div
						class="plan-card active"
						data-plan="pro-monthly"
						onclick="selectPlan('pro-monthly')"
					>
						<span>Pro Monthly</span>
						<span>$9.99</span>
					</div>
					<div
						class="plan-card"
						data-plan="pro-annual"
						onclick="selectPlan('pro-annual')"
					>
						<span>Pro Annual</span>
						<span>$79</span>
					</div>
					<div
						class="plan-card"
						data-plan="free"
						onclick="selectPlan('free')"
					>
						<span>Free</span>
						<span>5 scans/week</span>
					</div>
				</div>
				<div class="modal-actions">
					<button class="btn-primary" onclick="applyPlan()">
						Apply Plan
					</button>
					<button
						class="btn-secondary"
						onclick="closeModal('subscriptionModal')"
					>
						Cancel
					</button>
				</div>
			</div>
		</div>

		<div class="modal" id="exportModal">
			<div class="modal-card">
				<div class="modal-header">
					<div class="modal-title">Export Data</div>
					<button
						class="modal-close"
						onclick="closeModal('exportModal')"
					>
						<i class="fa-solid fa-xmark"></i>
					</button>
				</div>
				<div style="font-size: 12px; color: var(--text-secondary)">
					CSV export ready. This is a mock download.
				</div>
				<div class="modal-actions">
					<a
						class="btn-primary"
						href="#"
						onclick="
							showToast('Export started');
							closeModal('exportModal');
							return false;
						"
						>Download CSV</a
					>
					<button
						class="btn-secondary"
						onclick="closeModal('exportModal')"
					>
						Close
					</button>
				</div>
			</div>
		</div>

		<div class="modal" id="deleteModal">
			<div class="modal-card">
				<div class="modal-header">
					<div class="modal-title">Delete Account</div>
					<button
						class="modal-close"
						onclick="closeModal('deleteModal')"
					>
						<i class="fa-solid fa-xmark"></i>
					</button>
				</div>
				<div style="font-size: 12px; color: var(--text-secondary)">
					This will permanently remove your health data (mock).
				</div>
				<div
					style="
						margin-top: 12px;
						font-size: 12px;
						color: var(--text-secondary);
					"
				>
					Type <strong>DELETE</strong> to confirm.
				</div>
				<input
					id="deleteConfirmInput"
					type="text"
					placeholder="Type DELETE"
					style="
						width: 100%;
						margin-top: 8px;
						padding: 10px 12px;
						border-radius: 12px;
						border: 1px solid #e2e8f0;
					"
					oninput="handleDeleteInput()"
				/>
				<div class="modal-actions">
					<button
						class="btn-secondary"
						onclick="closeModal('deleteModal')"
					>
						Cancel
					</button>
					<button
						class="btn-danger"
						id="deleteConfirmBtn"
						onclick="confirmDelete()"
						disabled
					>
						Confirm Delete
					</button>
				</div>
			</div>
		</div>

		<div class="modal" id="reauthModal">
			<div class="modal-card">
				<div class="modal-header">
					<div class="modal-title">Re-Auth Devices</div>
					<button
						class="modal-close"
						onclick="closeModal('reauthModal')"
					>
						<i class="fa-solid fa-xmark"></i>
					</button>
				</div>
				<div
					style="
						font-size: 12px;
						color: var(--text-secondary);
						margin-bottom: 12px;
					"
				>
					Refresh tokens to keep your device sync active.
				</div>
				<div class="device-modal-list" id="reauthList"></div>
				<div class="modal-actions">
					<button class="btn-primary" onclick="reauthAll()">
						Re-Auth All
					</button>
					<button
						class="btn-secondary"
						onclick="closeModal('reauthModal')"
					>
						Close
					</button>
				</div>
			</div>
		</div>

		<div class="modal" id="findModal">
			<div class="modal-card">
				<div class="modal-header">
					<div class="modal-title">Find Devices</div>
					<button
						class="modal-close"
						onclick="closeModal('findModal')"
					>
						<i class="fa-solid fa-xmark"></i>
					</button>
				</div>
				<div class="scan-pill">
					<span class="scan-dot"></span>
					<span id="scanStatus">Scanning nearby devices...</span>
				</div>
				<div
					style="margin-top: 12px"
					class="device-modal-list"
					id="scanList"
				></div>
				<div class="modal-actions">
					<button class="btn-primary" onclick="startScan()">
						Scan Again
					</button>
					<button
						class="btn-secondary"
						onclick="closeModal('findModal')"
					>
						Close
					</button>
				</div>
			</div>
		</div>

		<div class="toast" id="toast">Saved</div>

		<script>
			const deviceState = {
				apple: {
					label: "Apple Health",
					connected: true,
					lastSync: "2m ago",
					syncing: false,
				},
				google: {
					label: "Google Fit",
					connected: false,
					lastSync: "",
					syncing: false,
				},
				garmin: {
					label: "Garmin",
					connected: false,
					lastSync: "",
					syncing: false,
				},
				fitbit: {
					label: "Fitbit",
					connected: true,
					lastSync: "12m ago",
					syncing: false,
				},
			};

			const unitValues = {
				weightKg: 72,
				heightCm: 172,
				waterMl: 2500,
				burnKcal: 620,
			};

			const planLabels = {
				"pro-monthly": "Pro Monthly",
				"pro-annual": "Pro Annual",
				free: "Free",
			};

			let unitMode = "metric";
			let selectedPlan = "pro-monthly";
			let toastTimer;
			let scanTimer;
			let resyncTimer;

			function toggleSwitch(el) {
				el.classList.toggle("active");
			}

			function toggleChip(el) {
				el.classList.toggle("active");
			}

			function setUnits(el) {
				const buttons = el.parentElement.querySelectorAll(".unit-btn");
				buttons.forEach((btn) => btn.classList.remove("active"));
				el.classList.add("active");
				unitMode =
					el.textContent.trim().toLowerCase() === "imperial"
						? "imperial"
						: "metric";
				updateUnitPreview();
				showToast(
					"Units set to " +
						(unitMode === "imperial" ? "Imperial" : "Metric"),
				);
			}

			function selectGoal(el) {
				// Remove selected from siblings
				const siblings =
					el.parentElement.querySelectorAll(".goal-option");
				siblings.forEach((sib) => sib.classList.remove("selected"));
				// Add to clicked
				el.classList.add("selected");
			}

			function updateUnitPreview() {
				const weightEl = document.getElementById("weightVal");
				const heightEl = document.getElementById("heightVal");
				const waterEl = document.getElementById("waterVal");
				const burnEl = document.getElementById("burnVal");

				if (unitMode === "imperial") {
					const weightLb = Math.round(unitValues.weightKg * 2.20462);
					const totalIn = Math.round(unitValues.heightCm / 2.54);
					const ft = Math.floor(totalIn / 12);
					const inch = totalIn % 12;
					const waterOz = Math.round(unitValues.waterMl * 0.033814);
					weightEl.textContent = weightLb + " lb";
					heightEl.textContent = ft + " ft " + inch + " in";
					waterEl.textContent = waterOz + " oz";
					burnEl.textContent = unitValues.burnKcal + " kcal";
				} else {
					weightEl.textContent = unitValues.weightKg + " kg";
					heightEl.textContent = unitValues.heightCm + " cm";
					waterEl.textContent =
						unitValues.waterMl.toLocaleString() + " ml";
					burnEl.textContent = unitValues.burnKcal + " kcal";
				}
			}

			function renderDevices() {
				Object.keys(deviceState).forEach((key) => {
					const row = document.querySelector(
						'.device-row[data-device="' + key + '"]',
					);
					if (!row) {
						return;
					}
					const statusEl = row.querySelector(".device-status");
					const toggleEl = row.querySelector(".toggle-switch");
					const state = deviceState[key];

					if (toggleEl) {
						toggleEl.classList.toggle("active", state.connected);
					}

					if (!statusEl) {
						return;
					}

					statusEl.classList.remove("synced-text", "syncing");
					if (state.syncing) {
						statusEl.textContent = "Syncing...";
						statusEl.classList.add("syncing");
						return;
					}

					if (state.connected) {
						statusEl.textContent =
							"Synced: " + (state.lastSync || "just now");
						statusEl.classList.add("synced-text");
					} else {
						statusEl.textContent = "Disconnected";
					}
				});
			}

			function toggleDevice(key) {
				const state = deviceState[key];
				if (!state) {
					return;
				}
				state.connected = !state.connected;
				state.syncing = false;
				state.lastSync = state.connected ? "just now" : "";
				renderDevices();
				showToast(
					state.label +
						(state.connected ? " connected" : " disconnected"),
				);
			}

			function forceResync() {
				const active = Object.keys(deviceState).filter(
					(key) => deviceState[key].connected,
				);
				if (!active.length) {
					showToast("No devices connected");
					return;
				}
				active.forEach((key) => {
					deviceState[key].syncing = true;
				});
				renderDevices();
				showToast("Resyncing devices...");
				clearTimeout(resyncTimer);
				resyncTimer = setTimeout(() => {
					active.forEach((key) => {
						deviceState[key].syncing = false;
						deviceState[key].lastSync = "just now";
					});
					renderDevices();
					showToast("Sync complete");
				}, 1200);
			}

			function openReauthModal() {
				buildReauthList();
				openModal("reauthModal");
			}

			function buildReauthList() {
				const list = document.getElementById("reauthList");
				if (!list) {
					return;
				}
				list.innerHTML = "";
				Object.keys(deviceState).forEach((key) => {
					const state = deviceState[key];
					const row = document.createElement("div");
					row.className = "device-modal-row";
					row.innerHTML =
						"<div><strong>" +
						state.label +
						"</strong><div>" +
						(state.connected ? "Active" : "Disconnected") +
						"</div></div>";
					const btn = document.createElement("button");
					btn.className = "device-action";
					btn.textContent = state.connected ? "Re-auth" : "Connect";
					btn.addEventListener("click", () => reauthDevice(key));
					row.appendChild(btn);
					list.appendChild(row);
				});
			}

			function reauthDevice(key) {
				const state = deviceState[key];
				if (!state) {
					return;
				}
				state.connected = true;
				state.lastSync = "just now";
				renderDevices();
				buildReauthList();
				showToast(state.label + " re-authenticated");
			}

			function reauthAll() {
				Object.keys(deviceState).forEach((key) => {
					deviceState[key].connected = true;
					deviceState[key].lastSync = "just now";
					deviceState[key].syncing = false;
				});
				renderDevices();
				buildReauthList();
				showToast("All devices re-authenticated");
			}

			function openFindModal() {
				openModal("findModal");
				startScan();
			}

			function startScan() {
				const statusEl = document.getElementById("scanStatus");
				const list = document.getElementById("scanList");
				if (statusEl) {
					statusEl.textContent = "Scanning nearby devices...";
				}
				if (list) {
					list.innerHTML = "";
				}
				clearTimeout(scanTimer);
				scanTimer = setTimeout(() => {
					renderScanResults();
					if (statusEl) {
						statusEl.textContent = "Devices found";
					}
				}, 900);
			}

			function renderScanResults() {
				const list = document.getElementById("scanList");
				if (!list) {
					return;
				}
				const results = [
					{
						key: "garmin",
						name: "Garmin Venu 2",
						signal: "Strong signal",
					},
					{
						key: "fitbit",
						name: "Fitbit Sense 2",
						signal: "Good signal",
					},
					{
						key: "google",
						name: "Pixel Watch",
						signal: "Good signal",
					},
				];
				list.innerHTML = "";
				results.forEach((item) => {
					const state = deviceState[item.key];
					const connected = state && state.connected;
					const row = document.createElement("div");
					row.className = "device-modal-row";
					row.innerHTML =
						"<div><strong>" +
						item.name +
						"</strong><div>" +
						item.signal +
						"</div></div>";
					const btn = document.createElement("button");
					btn.className =
						"device-action" + (connected ? " connected" : "");
					btn.textContent = connected ? "Connected" : "Connect";
					btn.addEventListener("click", () =>
						connectDevice(item.key),
					);
					row.appendChild(btn);
					list.appendChild(row);
				});
			}

			function connectDevice(key) {
				const state = deviceState[key];
				if (!state) {
					return;
				}
				if (state.connected) {
					return;
				}
				state.connected = true;
				state.lastSync = "just now";
				renderDevices();
				renderScanResults();
				showToast(state.label + " connected");
			}

			function selectPlan(planId) {
				selectedPlan = planId;
				document.querySelectorAll(".plan-card").forEach((card) => {
					card.classList.toggle(
						"active",
						card.dataset.plan === planId,
					);
				});
			}

			function applyPlan() {
				const label = planLabels[selectedPlan] || "Pro Monthly";
				document.getElementById("currentPlan").textContent = label;
				const badge = document.querySelector(".pro-badge");
				if (selectedPlan === "free") {
					badge.textContent = "FREE";
					badge.classList.add("free");
				} else {
					badge.textContent = "PRO";
					badge.classList.remove("free");
				}
				closeModal("subscriptionModal");
				showToast("Plan updated to " + label);
			}

			function handleDeleteInput() {
				const input = document.getElementById("deleteConfirmInput");
				const button = document.getElementById("deleteConfirmBtn");
				if (!input || !button) {
					return;
				}
				button.disabled = input.value.trim().toUpperCase() !== "DELETE";
			}

			function confirmDelete() {
				closeModal("deleteModal");
				showToast("Account deleted (mock)");
				const input = document.getElementById("deleteConfirmInput");
				if (input) {
					input.value = "";
				}
				handleDeleteInput();
			}

			function showToast(message) {
				const toast = document.getElementById("toast");
				if (!toast) {
					return;
				}
				toast.textContent = message;
				toast.classList.add("show");
				clearTimeout(toastTimer);
				toastTimer = setTimeout(
					() => toast.classList.remove("show"),
					1600,
				);
			}

			function openModal(id) {
				const modal = document.getElementById(id);
				if (modal) {
					modal.classList.add("active");
				}
			}

			function closeModal(id) {
				const modal = document.getElementById(id);
				if (modal) {
					modal.classList.remove("active");
				}
				if (id === "deleteModal") {
					const input = document.getElementById("deleteConfirmInput");
					if (input) {
						input.value = "";
					}
					handleDeleteInput();
				}
			}

			renderDevices();
			updateUnitPreview();
		</script>
	</body>
</html>
